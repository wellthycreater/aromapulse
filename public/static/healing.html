<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>힐링 체험 - 아로마펄스</title>
    <link rel="icon" type="image/png" href="/static/favicon.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" rel="stylesheet">
    <!-- Kakao Postcode Service for address search -->
    <script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
    <!-- Map APIs will be loaded dynamically based on user's OAuth provider -->
    <style>
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }
        
        .float-animation {
            animation: float 3s ease-in-out infinite;
        }
        
        .category-card {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .category-card:hover {
            transform: translateY(-15px) scale(1.05);
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.2);
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-white shadow-lg sticky top-0 z-50">
        <nav class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <a href="/" class="flex items-center space-x-3">
                    <img src="/static/logo-light.png" alt="아로마펄스" class="h-12 hover:scale-105 transition">
                </a>
                
                <div class="hidden md:flex items-center space-x-6">
                    <a href="/" class="text-gray-700 hover:text-purple-600 font-medium transition flex items-center">
                        <i class="fas fa-home mr-2"></i>홈
                    </a>
                    <a href="/shop" class="text-gray-700 hover:text-purple-600 font-medium transition flex items-center">
                        <i class="fas fa-shopping-bag mr-2"></i>쇼핑
                    </a>
                    <a href="/healing" class="text-purple-600 font-bold flex items-center">
                        <i class="fas fa-star mr-2"></i>힐링 체험
                    </a>
                </div>
                
                <div class="w-4"></div>
            </div>
        </nav>
    </header>

    <!-- Hero Section -->
    <section class="gradient-bg text-white py-24 relative overflow-hidden">
        <!-- Decorative Elements -->
        <div class="absolute top-10 left-10 w-64 h-64 bg-white opacity-10 rounded-full blur-3xl float-animation"></div>
        <div class="absolute bottom-10 right-10 w-96 h-96 bg-pink-300 opacity-10 rounded-full blur-3xl float-animation" style="animation-delay: 1s;"></div>
        
        <div class="container mx-auto px-6 text-center relative z-10">
            <div class="inline-block mb-6">
                <div class="bg-white bg-opacity-20 backdrop-blur-lg rounded-full px-6 py-3">
                    <i class="fas fa-star text-yellow-300 mr-2"></i>
                    <span class="font-semibold">힐링 체험</span>
                </div>
            </div>
            
            <h1 class="text-5xl md:text-6xl font-bold mb-6 leading-tight">
                나만의 향기로<br>
                <span class="text-yellow-300">특별한 시간을</span>
            </h1>
            <p class="text-xl md:text-2xl mb-8 text-purple-100">
                워크샵과 원데이 클래스로 일상의 스트레스를 해소하세요
            </p>
            
            <!-- Login Required Message (shown when not logged in) -->
            <div id="login-required-section" class="hidden mt-12 max-w-3xl mx-auto">
                <div class="bg-white/10 backdrop-blur-lg rounded-3xl p-8 border border-white/30">
                    <p class="text-xl font-bold mb-4">
                        <i class="fas fa-lock mr-2"></i>
                        로그인이 필요한 서비스입니다
                    </p>
                    <p class="text-purple-200 text-sm mb-6">
                        메인 페이지에서 로그인하신 후 공방을 지도에서 찾아보실 수 있습니다
                    </p>
                    <button onclick="location.href='/'" 
                            class="bg-white text-purple-600 px-8 py-4 rounded-full font-bold hover:shadow-xl transition transform hover:scale-105">
                        <i class="fas fa-home mr-2"></i>메인 페이지로 이동
                    </button>
                </div>
            </div>
            
            <!-- User Info Section (shown when logged in) -->
            <div id="user-info-section" class="hidden mt-12 max-w-3xl mx-auto">
                <div class="bg-white/10 backdrop-blur-lg rounded-3xl p-6 border border-white/30">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <div id="user-platform-icon" class="w-12 h-12 rounded-full flex items-center justify-center mr-4 bg-white">
                                <i class="fas fa-user text-purple-600 text-xl"></i>
                            </div>
                            <div class="text-left">
                                <p class="font-bold text-lg" id="user-name">사용자님</p>
                                <p class="text-purple-200 text-sm" id="user-platform">로그인 플랫폼</p>
                            </div>
                        </div>
                        <button onclick="logout()" 
                                class="bg-white/20 hover:bg-white/30 text-white px-6 py-2 rounded-full font-semibold transition">
                            로그아웃
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Categories Section -->
    <section class="container mx-auto px-6 py-16">
        <div class="grid md:grid-cols-2 gap-12 max-w-5xl mx-auto">
            <!-- Workshop Card -->
            <a href="/workshops" class="category-card bg-white rounded-3xl shadow-xl overflow-hidden block">
                <div class="aspect-video bg-gradient-to-br from-purple-500 via-pink-500 to-purple-600 flex items-center justify-center relative">
                    <i class="fas fa-briefcase text-9xl text-white opacity-30 float-animation"></i>
                    <div class="absolute top-4 right-4 bg-yellow-400 text-purple-900 px-4 py-2 rounded-full font-bold text-sm">
                        기업 전용
                    </div>
                </div>
                <div class="p-8">
                    <div class="flex items-center mb-4">
                        <i class="fas fa-briefcase text-3xl text-purple-600 mr-4"></i>
                        <h2 class="text-3xl font-bold text-gray-900">워크샵</h2>
                    </div>
                    <p class="text-gray-600 text-lg mb-6">
                        기업 맞춤형 팀빌딩 프로그램으로 직원들의 스트레스를 해소하고 팀워크를 강화하세요.
                    </p>
                    <div class="space-y-3 mb-6">
                        <div class="flex items-center text-gray-700">
                            <i class="fas fa-check-circle text-purple-600 mr-3"></i>
                            <span class="font-semibold">HR팀, 조직문화팀, 복리후생 담당자</span>
                        </div>
                        <div class="flex items-center text-gray-700">
                            <i class="fas fa-check-circle text-purple-600 mr-3"></i>
                            <span class="font-semibold">20인 이상 규모의 기업</span>
                        </div>
                        <div class="flex items-center text-gray-700">
                            <i class="fas fa-check-circle text-purple-600 mr-3"></i>
                            <span class="font-semibold">전문 강사 초빙 및 워케이션 옵션</span>
                        </div>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-purple-600 font-bold text-xl">기업 워크샵 보기</span>
                        <i class="fas fa-arrow-right text-purple-600 text-2xl"></i>
                    </div>
                </div>
            </a>

            <!-- Class Card -->
            <a href="/classes" class="category-card bg-white rounded-3xl shadow-xl overflow-hidden block">
                <div class="aspect-video bg-gradient-to-br from-green-400 via-teal-500 to-blue-500 flex items-center justify-center relative">
                    <i class="fas fa-calendar-alt text-9xl text-white opacity-30 float-animation" style="animation-delay: 0.5s;"></i>
                    <div class="absolute top-4 right-4 bg-yellow-400 text-green-900 px-4 py-2 rounded-full font-bold text-sm">
                        누구나 참여
                    </div>
                </div>
                <div class="p-8">
                    <div class="flex items-center mb-4">
                        <i class="fas fa-calendar-alt text-3xl text-green-600 mr-4"></i>
                        <h2 class="text-3xl font-bold text-gray-900">원데이 클래스</h2>
                    </div>
                    <p class="text-gray-600 text-lg mb-6">
                        소규모 힐링 클래스로 나만의 향을 만들며 특별한 시간을 보내세요.
                    </p>
                    <div class="space-y-3 mb-6">
                        <div class="flex items-center text-gray-700">
                            <i class="fas fa-check-circle text-green-600 mr-3"></i>
                            <span class="font-semibold">개인 및 소규모 그룹 (1~10명)</span>
                        </div>
                        <div class="flex items-center text-gray-700">
                            <i class="fas fa-check-circle text-green-600 mr-3"></i>
                            <span class="font-semibold">전문 조향사의 1:1 맞춤 지도</span>
                        </div>
                        <div class="flex items-center text-gray-700">
                            <i class="fas fa-check-circle text-green-600 mr-3"></i>
                            <span class="font-semibold">선물 포장 서비스 옵션</span>
                        </div>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-green-600 font-bold text-xl">클래스 보기</span>
                        <i class="fas fa-arrow-right text-green-600 text-2xl"></i>
                    </div>
                </div>
            </a>
        </div>
    </section>

    <!-- Google Maps Section (shown only when logged in with Google) -->
    <section id="maps-section" class="hidden container mx-auto px-6 py-16">
        <div class="bg-white rounded-3xl shadow-2xl overflow-hidden">
            <!-- Section Header -->
            <div class="bg-gradient-to-r from-purple-600 to-pink-600 text-white p-8">
                <div class="flex items-center justify-between flex-wrap gap-4">
                    <div>
                        <h2 class="text-3xl font-bold mb-3">
                            <i class="fas fa-map-marked-alt mr-3"></i>
                            전국 아로마 공방 찾기
                        </h2>
                        <p class="text-purple-100">
                            <span id="map-provider-name">Google Maps</span>로 가까운 공방을 찾아보세요
                        </p>
                    </div>
                    <button onclick="showLocationModal()" class="bg-white text-purple-600 px-6 py-3 rounded-xl font-semibold hover:bg-purple-50 transition flex items-center gap-2 shadow-lg">
                        <i class="fas fa-location-crosshairs"></i>
                        <span>내 위치로 검색</span>
                    </button>
                </div>
            </div>

            <!-- Map Container -->
            <div class="relative">
                <div id="map" class="w-full h-[600px] bg-gray-100"></div>
                
                <!-- Loading Overlay -->
                <div id="map-loading" class="absolute inset-0 flex items-center justify-center bg-white bg-opacity-90">
                    <div class="text-center">
                        <div class="inline-block animate-spin rounded-full h-12 w-12 border-b-4 border-purple-600 mb-4"></div>
                        <p class="text-gray-600 font-semibold">지도를 불러오는 중...</p>
                    </div>
                </div>
            </div>

            <!-- Workshop List -->
            <div class="p-8 bg-gray-50">
                <h3 class="text-2xl font-bold text-gray-900 mb-6">
                    <i class="fas fa-list mr-3"></i>
                    공방 목록
                </h3>
                <div id="workshops-list" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Workshops will be loaded here -->
                </div>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="bg-gradient-to-r from-purple-50 to-pink-50 py-16">
        <div class="container mx-auto px-6">
            <h2 class="text-3xl font-bold text-center text-gray-900 mb-12">
                <i class="fas fa-heart text-pink-600 mr-3"></i>
                왜 아로마펄스 힐링 체험인가요?
            </h2>
            <div class="grid md:grid-cols-3 gap-8 max-w-5xl mx-auto">
                <div class="bg-white rounded-2xl p-6 shadow-lg text-center">
                    <div class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-user-tie text-purple-600 text-3xl"></i>
                    </div>
                    <h3 class="text-xl font-bold text-gray-900 mb-3">전문 조향사</h3>
                    <p class="text-gray-600">
                        경험이 풍부한 전문 조향사가 직접 진행하는 수준 높은 프로그램
                    </p>
                </div>
                <div class="bg-white rounded-2xl p-6 shadow-lg text-center">
                    <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-leaf text-green-600 text-3xl"></i>
                    </div>
                    <h3 class="text-xl font-bold text-gray-900 mb-3">천연 재료</h3>
                    <p class="text-gray-600">
                        엄선된 천연 에센셜 오일과 친환경 재료만 사용합니다
                    </p>
                </div>
                <div class="bg-white rounded-2xl p-6 shadow-lg text-center">
                    <div class="w-16 h-16 bg-pink-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-heart text-pink-600 text-3xl"></i>
                    </div>
                    <h3 class="text-xl font-bold text-gray-900 mb-3">맞춤 힐링</h3>
                    <p class="text-gray-600">
                        개인 또는 팀의 니즈에 맞춘 맞춤형 프로그램 제공
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- Business Partnership Section (예비 공방 대표를 위한 섹션) -->
    <section class="bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 py-20 relative overflow-hidden">
        <!-- Animated Background Elements -->
        <div class="absolute top-0 left-0 w-full h-full overflow-hidden">
            <div class="absolute top-20 left-10 w-72 h-72 bg-purple-500 opacity-20 rounded-full blur-3xl float-animation"></div>
            <div class="absolute bottom-20 right-10 w-96 h-96 bg-pink-500 opacity-20 rounded-full blur-3xl float-animation" style="animation-delay: 1.5s;"></div>
            <div class="absolute top-1/2 left-1/2 w-64 h-64 bg-yellow-400 opacity-10 rounded-full blur-3xl float-animation" style="animation-delay: 0.7s;"></div>
        </div>
        
        <div class="container mx-auto px-6 relative z-10">
            <!-- Section Header -->
            <div class="text-center mb-16">
                <div class="inline-block mb-4">
                    <div class="bg-gradient-to-r from-yellow-400 via-pink-500 to-purple-500 text-white px-8 py-3 rounded-full font-bold text-sm shadow-2xl">
                        <i class="fas fa-expand-arrows-alt mr-2"></i>기존 공방 사장님을 위한 무인 공방 확장
                    </div>
                </div>
                <h2 class="text-4xl md:text-6xl font-bold text-white mb-6 leading-tight">
                    공방 운영 경험을<br>
                    <span class="text-transparent bg-clip-text bg-gradient-to-r from-yellow-300 via-pink-400 to-purple-400">무인 자동화로 확장하세요</span>
                </h2>
                <p class="text-xl md:text-2xl text-purple-200 max-w-4xl mx-auto leading-relaxed mb-4">
                    이미 공방을 운영하고 계신가요? 💼<br>
                    노하우는 그대로, 인건비는 제로! 무인 시스템으로 2호점, 3호점을 열어보세요
                </p>
                <div class="flex items-center justify-center gap-6 mt-6 flex-wrap">
                    <div class="flex items-center bg-white bg-opacity-10 backdrop-blur-lg px-6 py-3 rounded-full">
                        <i class="fas fa-user-tie text-yellow-400 mr-2 text-xl"></i>
                        <span class="text-white font-semibold">운영 경험자 전용</span>
                    </div>
                    <div class="flex items-center bg-white bg-opacity-10 backdrop-blur-lg px-6 py-3 rounded-full">
                        <i class="fas fa-store text-pink-400 mr-2 text-xl"></i>
                        <span class="text-white font-semibold">다점포 확장 지원</span>
                    </div>
                    <div class="flex items-center bg-white bg-opacity-10 backdrop-blur-lg px-6 py-3 rounded-full">
                        <i class="fas fa-robot text-green-400 mr-2 text-xl"></i>
                        <span class="text-white font-semibold">완전 무인 자동화</span>
                    </div>
                </div>
            </div>

            <!-- 웰씨코리아 시스템 상세 설명 -->
            <div class="mb-16">
                <div class="text-center mb-10">
                    <div class="inline-block bg-gradient-to-r from-green-500 to-teal-500 text-white px-6 py-2 rounded-full font-bold text-sm mb-4 shadow-lg">
                        <i class="fas fa-chart-line mr-2"></i>웰씨코리아 통합 운영 시스템
                    </div>
                    <h3 class="text-3xl md:text-4xl font-bold text-white mb-4">
                        📊 모든 것을 하나의 플랫폼에서
                    </h3>
                    <p class="text-xl text-purple-200 max-w-3xl mx-auto">
                        예약부터 정산까지, 웰씨코리아가 제공하는 통합 시스템으로<br>
                        <strong class="text-white">운영 부담 ZERO, 데이터 기반 성장</strong>을 경험하세요
                    </p>
                </div>

                <div class="grid md:grid-cols-2 gap-8">
                    <!-- 1. 통합 예약/결제 시스템 -->
                    <div class="bg-white/5 backdrop-blur-lg rounded-2xl p-8 border border-white/10">
                        <div class="flex items-center mb-6">
                            <div class="w-16 h-16 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-xl flex items-center justify-center mr-4">
                                <i class="fas fa-calendar-check text-white text-2xl"></i>
                            </div>
                            <div>
                                <h4 class="text-2xl font-bold text-white">예약/결제 자동화</h4>
                                <p class="text-purple-300 text-sm">24시간 무인 예약 시스템</p>
                            </div>
                        </div>
                        <ul class="space-y-3 text-purple-100">
                            <li class="flex items-start">
                                <i class="fas fa-check text-green-400 mr-3 mt-1"></i>
                                <span>네이버 예약/카카오톡 자동 연동</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-check text-green-400 mr-3 mt-1"></i>
                                <span>실시간 예약 현황 모니터링</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-check text-green-400 mr-3 mt-1"></i>
                                <span>자동 결제/환불 처리</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-check text-green-400 mr-3 mt-1"></i>
                                <span>노쇼 방지 시스템 (임시 비밀번호)</span>
                            </li>
                        </ul>
                    </div>

                    <!-- 2. 매출/정산 관리 -->
                    <div class="bg-white/5 backdrop-blur-lg rounded-2xl p-8 border border-white/10">
                        <div class="flex items-center mb-6">
                            <div class="w-16 h-16 bg-gradient-to-r from-green-500 to-teal-500 rounded-xl flex items-center justify-center mr-4">
                                <i class="fas fa-money-check-alt text-white text-2xl"></i>
                            </div>
                            <div>
                                <h4 class="text-2xl font-bold text-white">매출/정산 관리</h4>
                                <p class="text-purple-300 text-sm">투명한 수익 공유 시스템</p>
                            </div>
                        </div>
                        <ul class="space-y-3 text-purple-100">
                            <li class="flex items-start">
                                <i class="fas fa-check text-green-400 mr-3 mt-1"></i>
                                <span>실시간 매출 대시보드</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-check text-green-400 mr-3 mt-1"></i>
                                <span>자동 수익 배분 정산 (매월)</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-check text-green-400 mr-3 mt-1"></i>
                                <span>세금계산서 자동 발행</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-check text-green-400 mr-3 mt-1"></i>
                                <span>수익성 분석 리포트 제공</span>
                            </li>
                        </ul>
                    </div>

                    <!-- 3. CS/고객관리 -->
                    <div class="bg-white/5 backdrop-blur-lg rounded-2xl p-8 border border-white/10">
                        <div class="flex items-center mb-6">
                            <div class="w-16 h-16 bg-gradient-to-r from-purple-500 to-pink-500 rounded-xl flex items-center justify-center mr-4">
                                <i class="fas fa-headset text-white text-2xl"></i>
                            </div>
                            <div>
                                <h4 class="text-2xl font-bold text-white">CS/고객관리</h4>
                                <p class="text-purple-300 text-sm">24/7 고객 응대 시스템</p>
                            </div>
                        </div>
                        <ul class="space-y-3 text-purple-100">
                            <li class="flex items-start">
                                <i class="fas fa-check text-green-400 mr-3 mt-1"></i>
                                <span>챗봇 기반 자동 고객 응대</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-check text-green-400 mr-3 mt-1"></i>
                                <span>리뷰/평점 관리 자동화</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-check text-green-400 mr-3 mt-1"></i>
                                <span>고객 불만 처리 지원</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-check text-green-400 mr-3 mt-1"></i>
                                <span>CRM 데이터 분석 제공</span>
                            </li>
                        </ul>
                    </div>

                    <!-- 4. 데이터 분석/인사이트 -->
                    <div class="bg-white/5 backdrop-blur-lg rounded-2xl p-8 border border-white/10 relative overflow-hidden">
                        <div class="absolute top-2 right-2 bg-gradient-to-r from-yellow-400 to-orange-500 text-white px-3 py-1 rounded-full font-bold text-xs">
                            🔥 핵심 가치
                        </div>
                        <div class="flex items-center mb-6">
                            <div class="w-16 h-16 bg-gradient-to-r from-yellow-500 to-orange-500 rounded-xl flex items-center justify-center mr-4">
                                <i class="fas fa-chart-bar text-white text-2xl"></i>
                            </div>
                            <div>
                                <h4 class="text-2xl font-bold text-white">데이터 분석</h4>
                                <p class="text-purple-300 text-sm">AI 기반 비즈니스 인사이트</p>
                            </div>
                        </div>
                        <ul class="space-y-3 text-purple-100">
                            <li class="flex items-start">
                                <i class="fas fa-check text-green-400 mr-3 mt-1"></i>
                                <span>고객 행동 패턴 분석</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-check text-green-400 mr-3 mt-1"></i>
                                <span>인기 시간대/상품 분석</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-check text-green-400 mr-3 mt-1"></i>
                                <span>맞춤형 마케팅 추천</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-check text-green-400 mr-3 mt-1"></i>
                                <span>경쟁사 벤치마킹 데이터</span>
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- 데이터 활용 가치 강조 -->
                <div class="mt-8 bg-gradient-to-r from-blue-500/20 to-purple-500/20 rounded-2xl p-8 border border-blue-400/30">
                    <div class="flex items-start">
                        <i class="fas fa-database text-blue-400 text-4xl mr-4 mt-1"></i>
                        <div>
                            <div class="text-blue-300 font-bold text-2xl mb-4">📈 데이터 기반 성장 전략</div>
                            <p class="text-purple-100 leading-relaxed mb-4">
                                웰씨코리아는 단순히 시스템만 제공하는 것이 아닙니다. 
                                <strong class="text-white">모든 매장에서 수집되는 운영 데이터를 분석</strong>하여 
                                사장님께 <strong class="text-yellow-300">실질적인 비즈니스 인사이트</strong>를 제공합니다.
                            </p>
                            <div class="grid md:grid-cols-3 gap-4 mt-6">
                                <div class="bg-white/10 backdrop-blur-lg rounded-xl p-4 text-center">
                                    <div class="text-3xl font-bold text-white mb-2">95%</div>
                                    <div class="text-purple-200 text-sm">데이터 기반 의사결정</div>
                                </div>
                                <div class="bg-white/10 backdrop-blur-lg rounded-xl p-4 text-center">
                                    <div class="text-3xl font-bold text-white mb-2">+40%</div>
                                    <div class="text-purple-200 text-sm">평균 매출 증가율</div>
                                </div>
                                <div class="bg-white/10 backdrop-blur-lg rounded-xl p-4 text-center">
                                    <div class="text-3xl font-bold text-white mb-2">24/7</div>
                                    <div class="text-purple-200 text-sm">실시간 모니터링</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Benefits Grid -->
            <div class="grid md:grid-cols-3 gap-8 mb-16">
                <!-- Benefit 1: 맞춤형 리모델링 -->
                <div class="category-card bg-gradient-to-br from-white/10 to-white/5 backdrop-blur-lg rounded-3xl p-8 border border-white/30 hover:border-yellow-400/50 shadow-2xl">
                    <div class="relative mb-6">
                        <div class="w-20 h-20 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-2xl flex items-center justify-center shadow-xl">
                            <i class="fas fa-pencil-ruler text-white text-4xl"></i>
                        </div>
                        <div class="absolute -top-2 -right-2 bg-red-500 text-white text-xs font-bold px-3 py-1 rounded-full">
                            핵심
                        </div>
                    </div>
                    <h3 class="text-2xl font-bold text-white mb-4">🎨 사장님 스타일 맞춤 리모델링</h3>
                    <p class="text-purple-200 leading-relaxed mb-4">
                        공간은 제공받고, 인테리어는 사장님이 원하는 대로!<br>
                        <span class="text-yellow-300 font-bold">브랜드 정체성을 그대로 유지</span>하세요
                    </p>
                    <ul class="space-y-3 text-purple-100">
                        <li class="flex items-start">
                            <i class="fas fa-crown text-yellow-400 mr-3 mt-1"></i>
                            <span><strong>100% 자유로운 인테리어</strong><br><span class="text-sm text-purple-300">기존 브랜드 컨셉 그대로 적용</span></span>
                        </li>
                        <li class="flex items-start">
                            <i class="fas fa-crown text-yellow-400 mr-3 mt-1"></i>
                            <span><strong>인테리어 시공사 연결</strong><br><span class="text-sm text-purple-300">검증된 업체 추천 및 견적 지원</span></span>
                        </li>
                        <li class="flex items-start">
                            <i class="fas fa-crown text-yellow-400 mr-3 mt-1"></i>
                            <span><strong>무인 시스템 통합 설치</strong><br><span class="text-sm text-purple-300">도어락, CCTV, 키오스크 등</span></span>
                        </li>
                    </ul>
                </div>

                <!-- Benefit 2: 자동화 운영 시스템 -->
                <div class="category-card bg-gradient-to-br from-white/10 to-white/5 backdrop-blur-lg rounded-3xl p-8 border border-white/30 hover:border-pink-400/50 shadow-2xl">
                    <div class="relative mb-6">
                        <div class="w-20 h-20 bg-gradient-to-r from-pink-400 to-purple-500 rounded-2xl flex items-center justify-center shadow-xl">
                            <i class="fas fa-robot text-white text-4xl"></i>
                        </div>
                        <div class="absolute -top-2 -right-2 bg-green-500 text-white text-xs font-bold px-3 py-1 rounded-full">
                            HOT
                        </div>
                    </div>
                    <h3 class="text-2xl font-bold text-white mb-4">🤖 웰씨코리아 무인 시스템</h3>
                    <p class="text-purple-200 leading-relaxed mb-4">
                        <span class="text-pink-300 font-bold">직원 없이 운영 가능!</span><br>
                        웰씨코리아 통합 플랫폼으로 모든 것을 자동화
                    </p>
                    <ul class="space-y-3 text-purple-100">
                        <li class="flex items-start">
                            <i class="fas fa-sparkles text-pink-400 mr-3 mt-1"></i>
                            <span><strong>예약/결제/정산 통합</strong><br><span class="text-sm text-purple-300">웰씨코리아 시스템으로 자동화</span></span>
                        </li>
                        <li class="flex items-start">
                            <i class="fas fa-sparkles text-pink-400 mr-3 mt-1"></i>
                            <span><strong>스마트 출입 관리</strong><br><span class="text-sm text-purple-300">IoT 도어락 자동 제어</span></span>
                        </li>
                        <li class="flex items-start">
                            <i class="fas fa-sparkles text-pink-400 mr-3 mt-1"></i>
                            <span><strong>실시간 대시보드</strong><br><span class="text-sm text-purple-300">매출/예약 현황 모니터링</span></span>
                        </li>
                    </ul>
                </div>

                <!-- Benefit 3: 다점포 확장 지원 -->
                <div class="category-card bg-gradient-to-br from-white/10 to-white/5 backdrop-blur-lg rounded-3xl p-8 border border-white/30 hover:border-blue-400/50 shadow-2xl">
                    <div class="relative mb-6">
                        <div class="w-20 h-20 bg-gradient-to-r from-blue-400 to-teal-500 rounded-2xl flex items-center justify-center shadow-xl">
                            <i class="fas fa-chart-line text-white text-4xl"></i>
                        </div>
                        <div class="absolute -top-2 -right-2 bg-purple-500 text-white text-xs font-bold px-3 py-1 rounded-full">
                            추천
                        </div>
                    </div>
                    <h3 class="text-2xl font-bold text-white mb-4">📈 손쉬운 다점포 확장</h3>
                    <p class="text-purple-200 leading-relaxed mb-4">
                        <span class="text-blue-300 font-bold">1호점 성공 노하우를</span> 2호점, 3호점에 복제!<br>
                        직원 없이 매장 수만 늘리세요
                    </p>
                    <ul class="space-y-3 text-purple-100">
                        <li class="flex items-start">
                            <i class="fas fa-sparkles text-blue-400 mr-3 mt-1"></i>
                            <span><strong>검증된 매물 소개</strong><br><span class="text-sm text-purple-300">전국 주요 상권 공간 확보</span></span>
                        </li>
                        <li class="flex items-start">
                            <i class="fas fa-sparkles text-blue-400 mr-3 mt-1"></i>
                            <span><strong>통합 관리 시스템</strong><br><span class="text-sm text-purple-300">모든 매장 하나의 앱으로</span></span>
                        </li>
                        <li class="flex items-start">
                            <i class="fas fa-sparkles text-blue-400 mr-3 mt-1"></i>
                            <span><strong>아로마펄스 플랫폼 입점</strong><br><span class="text-sm text-purple-300">고객 유입 자동화 (수수료 5%)</span></span>
                        </li>
                    </ul>
                </div>
            </div>

            <!-- Success Stats -->
            <div class="relative mb-16">
                <div class="bg-gradient-to-r from-white/10 via-white/5 to-white/10 backdrop-blur-lg rounded-3xl p-12 border border-white/30 shadow-2xl">
                    <div class="text-center mb-10">
                        <div class="inline-block bg-gradient-to-r from-yellow-400 to-pink-500 text-white px-6 py-2 rounded-full font-bold text-sm mb-4">
                            <i class="fas fa-fire mr-2"></i>실시간 데이터
                        </div>
                        <h3 class="text-3xl md:text-4xl font-bold text-white">
                            무인 공방 파트너 성공 지표 📈
                        </h3>
                    </div>
                    <div class="grid md:grid-cols-4 gap-8 text-center">
                        <div class="bg-white/5 rounded-2xl p-6 hover:bg-white/10 transition">
                            <div class="text-6xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-yellow-300 to-orange-400 mb-3">8+</div>
                            <div class="text-purple-200 font-semibold text-lg">기존 사장님 확장</div>
                            <div class="text-purple-300 text-sm mt-2">평균 2.3호점 운영</div>
                        </div>
                        <div class="bg-white/5 rounded-2xl p-6 hover:bg-white/10 transition">
                            <div class="text-6xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-pink-300 to-purple-400 mb-3">0명</div>
                            <div class="text-purple-200 font-semibold text-lg">추가 인건비</div>
                            <div class="text-purple-300 text-sm mt-2">무인 자동화</div>
                        </div>
                        <div class="bg-white/5 rounded-2xl p-6 hover:bg-white/10 transition">
                            <div class="text-6xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-green-300 to-teal-400 mb-3">24/7</div>
                            <div class="text-purple-200 font-semibold text-lg">무인 운영</div>
                            <div class="text-purple-300 text-sm mt-2">밤낮 없이 매출</div>
                        </div>
                        <div class="bg-white/5 rounded-2xl p-6 hover:bg-white/10 transition">
                            <div class="text-6xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-300 to-cyan-400 mb-3">96%</div>
                            <div class="text-purple-200 font-semibold text-lg">만족도</div>
                            <div class="text-purple-300 text-sm mt-2">확장 성공률</div>
                        </div>
                    </div>
                    
                    <!-- Additional Stats Row -->
                    <div class="grid md:grid-cols-3 gap-6 mt-8">
                        <div class="bg-gradient-to-r from-yellow-500/20 to-orange-500/20 rounded-2xl p-6 border border-yellow-400/30">
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="text-yellow-300 text-2xl font-bold">평균 2.8개월</div>
                                    <div class="text-purple-200 text-sm">2호점 손익분기</div>
                                </div>
                                <i class="fas fa-rocket text-yellow-400 text-3xl"></i>
                            </div>
                        </div>
                        <div class="bg-gradient-to-r from-pink-500/20 to-purple-500/20 rounded-2xl p-6 border border-pink-400/30">
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="text-pink-300 text-2xl font-bold">+180%</div>
                                    <div class="text-purple-200 text-sm">확장 후 매출 증가</div>
                                </div>
                                <i class="fas fa-chart-line text-pink-400 text-3xl"></i>
                            </div>
                        </div>
                        <div class="bg-gradient-to-r from-green-500/20 to-teal-500/20 rounded-2xl p-6 border border-green-400/30">
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="text-green-300 text-2xl font-bold">-70%</div>
                                    <div class="text-purple-200 text-sm">인건비 절감</div>
                                </div>
                                <i class="fas fa-piggy-bank text-green-400 text-3xl"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Revenue Share Model -->
            <div class="bg-gradient-to-r from-slate-800 to-purple-900 rounded-3xl p-10 mb-16 border border-white/20">
                <div class="text-center mb-8">
                    <div class="inline-block mb-4">
                        <div class="bg-gradient-to-r from-green-400 to-teal-500 text-white px-6 py-2 rounded-full font-bold text-sm shadow-lg">
                            <i class="fas fa-handshake mr-2"></i>WIN-WIN 수익 공유 모델
                        </div>
                    </div>
                    <h3 class="text-3xl md:text-4xl font-bold text-white mb-4">
                        💰 월세 ZERO! 순수익만 나누세요
                    </h3>
                    <p class="text-xl text-purple-200">
                        오프라인 매출 기준, 순수익에서만 수수료 정산!<br>
                        온라인 판매는 각자 수익 💻
                    </p>
                </div>
                
                <!-- Revenue Share Highlights -->
                <div class="grid md:grid-cols-3 gap-6 mb-8">
                    <div class="bg-gradient-to-br from-green-500/20 to-teal-500/20 rounded-2xl p-6 border border-green-400/30">
                        <div class="text-center">
                            <div class="text-5xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-green-300 to-teal-300 mb-3">0원</div>
                            <div class="text-white font-bold text-xl mb-2">보증금 ZERO</div>
                            <div class="text-purple-200 text-sm">초기 부담 없음</div>
                        </div>
                    </div>
                    <div class="bg-gradient-to-br from-pink-500/20 to-purple-500/20 rounded-2xl p-6 border border-pink-400/30">
                        <div class="text-center">
                            <div class="text-5xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-pink-300 to-purple-300 mb-3">0원</div>
                            <div class="text-white font-bold text-xl mb-2">월세 ZERO</div>
                            <div class="text-purple-200 text-sm">고정비 부담 없음</div>
                        </div>
                    </div>
                    <div class="bg-gradient-to-br from-yellow-500/20 to-orange-500/20 rounded-2xl p-6 border border-yellow-400/30">
                        <div class="text-center">
                            <div class="text-5xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-yellow-300 to-orange-300 mb-3">수익%</div>
                            <div class="text-white font-bold text-xl mb-2">수익만 공유</div>
                            <div class="text-purple-200 text-sm">성과 기반 정산</div>
                        </div>
                    </div>
                </div>

                <!-- Revenue Share Details -->
                <div class="bg-white/5 backdrop-blur-lg rounded-2xl p-8 border border-white/10 mb-6">
                    <h4 class="text-2xl font-bold text-white mb-6 flex items-center">
                        <i class="fas fa-percentage text-yellow-400 mr-3"></i>
                        수익 공유 구조
                    </h4>
                    <div class="space-y-6">
                        <!-- Revenue Share Consultation Notice -->
                        <div class="bg-gradient-to-r from-purple-500/20 to-pink-500/20 rounded-2xl p-8 border border-purple-400/30 text-center mb-6">
                            <div class="inline-block bg-white/10 backdrop-blur-lg px-6 py-3 rounded-full mb-4">
                                <i class="fas fa-handshake text-yellow-400 text-2xl mr-3"></i>
                                <span class="text-white font-bold text-xl">맞춤 수익 배분율 제안</span>
                            </div>
                            <p class="text-purple-100 text-lg leading-relaxed mb-4">
                                각 매장의 입지, 규모, 운영 방식에 따라 <strong class="text-white">최적화된 수익 배분율</strong>을 제안해드립니다.<br>
                                상담을 통해 <strong class="text-yellow-300">사장님께 가장 유리한 조건</strong>을 찾아드립니다.
                            </p>
                            <div class="bg-white/10 backdrop-blur-lg rounded-xl p-4 mt-4">
                                <div class="grid md:grid-cols-3 gap-4 text-sm">
                                    <div class="text-center">
                                        <div class="text-green-300 font-bold mb-1">✅ 순수익 기준</div>
                                        <div class="text-purple-200">수익에서만 수수료</div>
                                    </div>
                                    <div class="text-center">
                                        <div class="text-blue-300 font-bold mb-1">🏪 오프라인 매출만</div>
                                        <div class="text-purple-200">현장 판매 기준</div>
                                    </div>
                                    <div class="text-center">
                                        <div class="text-yellow-300 font-bold mb-1">💻 온라인 별도</div>
                                        <div class="text-purple-200">각자 100% 수익</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Revenue Share Benefits -->
                        <div class="grid md:grid-cols-2 gap-6">
                            <div class="bg-purple-500/10 rounded-xl p-6 border border-purple-400/20">
                                <div class="flex items-center mb-4">
                                    <i class="fas fa-user-tie text-purple-400 text-2xl mr-3"></i>
                                    <div class="text-purple-200 font-semibold">사장님 수익</div>
                                </div>
                                <div class="text-3xl font-bold text-white mb-2">큰 비중 배분</div>
                                <p class="text-purple-200 text-sm">
                                    운영, 마케팅, 콘텐츠 제작 등<br>
                                    모든 노력에 대한 정당한 보상
                                </p>
                            </div>
                            <div class="bg-pink-500/10 rounded-xl p-6 border border-pink-400/20">
                                <div class="flex items-center mb-4">
                                    <i class="fas fa-building text-pink-400 text-2xl mr-3"></i>
                                    <div class="text-pink-200 font-semibold">아로마펄스 지원</div>
                                </div>
                                <div class="text-3xl font-bold text-white mb-2">공간 + 시스템</div>
                                <p class="text-pink-200 text-sm">
                                    공간 제공, 시설 유지보수,<br>
                                    플랫폼 마케팅 지원
                                </p>
                            </div>
                        </div>

                        <!-- Key Features -->
                        <div class="bg-blue-500/10 rounded-xl p-6 border border-blue-400/20">
                            <h5 class="text-lg font-bold text-blue-300 mb-4">
                                <i class="fas fa-check-circle mr-2"></i>수익 공유 모델의 핵심
                            </h5>
                            <div class="grid md:grid-cols-2 gap-4">
                                <div class="flex items-start">
                                    <i class="fas fa-arrow-right text-green-400 mr-3 mt-1"></i>
                                    <span class="text-purple-100"><strong>순수익 기준 정산</strong> - 매출이 아닌 순이익에서만</span>
                                </div>
                                <div class="flex items-start">
                                    <i class="fas fa-arrow-right text-green-400 mr-3 mt-1"></i>
                                    <span class="text-purple-100"><strong>오프라인 매출만 해당</strong> - 현장 판매 기준</span>
                                </div>
                                <div class="flex items-start">
                                    <i class="fas fa-arrow-right text-green-400 mr-3 mt-1"></i>
                                    <span class="text-purple-100"><strong>온라인 판매 제외</strong> - 각자 100% 수익</span>
                                </div>
                                <div class="flex items-start">
                                    <i class="fas fa-arrow-right text-green-400 mr-3 mt-1"></i>
                                    <span class="text-purple-100"><strong>투명한 정산</strong> - 매월 자동 정산 리포트</span>
                                </div>
                                <div class="flex items-start">
                                    <i class="fas fa-arrow-right text-green-400 mr-3 mt-1"></i>
                                    <span class="text-purple-100"><strong>리스크 제로</strong> - 수익 없으면 비용도 없음</span>
                                </div>
                                <div class="flex items-start">
                                    <i class="fas fa-arrow-right text-green-400 mr-3 mt-1"></i>
                                    <span class="text-purple-100"><strong>초기 투자 최소화</strong> - 인테리어+시스템만</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Investment Breakdown -->
                <div class="bg-white/5 backdrop-blur-lg rounded-2xl p-8 border border-white/10">
                    <h4 class="text-2xl font-bold text-white mb-6 flex items-center">
                        <i class="fas fa-wallet text-green-400 mr-3"></i>
                        실제 필요한 초기 투자
                    </h4>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="space-y-4">
                            <div class="flex justify-between items-center p-4 bg-white/5 rounded-xl">
                                <span class="text-purple-200">인테리어 (사장님 선택)</span>
                                <strong class="text-white text-xl">1,000~3,000만원</strong>
                            </div>
                            <div class="flex justify-between items-center p-4 bg-white/5 rounded-xl">
                                <span class="text-purple-200">무인 시스템 설치</span>
                                <strong class="text-white text-xl">500~800만원</strong>
                            </div>
                        </div>
                        <div class="flex items-center justify-center">
                            <div class="text-center bg-gradient-to-br from-yellow-500/20 to-orange-500/20 rounded-2xl p-8 border border-yellow-400/30 w-full">
                                <div class="text-yellow-300 text-sm mb-2">총 예상 투자</div>
                                <div class="text-5xl font-bold text-white mb-3">1,500~<br>3,800만원</div>
                                <div class="text-purple-200 text-sm">
                                    ※ 보증금/월세 없이 시작!
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Highlight Box -->
                <div class="mt-6 bg-gradient-to-r from-yellow-500/20 to-orange-500/20 rounded-2xl p-6 border border-yellow-400/30">
                    <div class="flex items-start">
                        <i class="fas fa-star text-yellow-400 text-3xl mr-4 mt-1"></i>
                        <div>
                            <div class="text-yellow-300 font-bold text-xl mb-3">💡 인테리어 100% 자유 + 공간 무료 제공!</div>
                            <p class="text-purple-200 leading-relaxed mb-4">
                                <strong class="text-white">공간은 저희가 제공</strong>하고, 인테리어는 사장님이 원하는 컨셉대로 자유롭게! 
                                기존 브랜드 아이덴티티를 그대로 유지하면서 무인 시스템의 효율성을 더하세요.
                            </p>
                            <div class="flex flex-wrap gap-3">
                                <span class="bg-white/10 px-4 py-2 rounded-full text-sm text-white font-semibold">
                                    <i class="fas fa-check-circle text-green-400 mr-2"></i>보증금 ZERO
                                </span>
                                <span class="bg-white/10 px-4 py-2 rounded-full text-sm text-white font-semibold">
                                    <i class="fas fa-check-circle text-green-400 mr-2"></i>월세 ZERO
                                </span>
                                <span class="bg-white/10 px-4 py-2 rounded-full text-sm text-white font-semibold">
                                    <i class="fas fa-check-circle text-green-400 mr-2"></i>순수익 기준 정산
                                </span>
                                <span class="bg-white/10 px-4 py-2 rounded-full text-sm text-white font-semibold">
                                    <i class="fas fa-check-circle text-green-400 mr-2"></i>오프라인만 공유
                                </span>
                                <span class="bg-white/10 px-4 py-2 rounded-full text-sm text-white font-semibold">
                                    <i class="fas fa-check-circle text-green-400 mr-2"></i>온라인 각자 수익
                                </span>
                                <span class="bg-white/10 px-4 py-2 rounded-full text-sm text-white font-semibold">
                                    <i class="fas fa-check-circle text-green-400 mr-2"></i>투명한 리포트
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- CTA Box -->
            <div class="relative overflow-hidden rounded-3xl">
                <div class="absolute inset-0 bg-gradient-to-r from-yellow-400 via-pink-500 to-purple-500"></div>
                <div class="absolute inset-0 opacity-30">
                    <div class="absolute top-0 left-0 w-full h-full bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PHBhdHRlcm4gaWQ9ImdyaWQiIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgcGF0dGVyblVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+PHBhdGggZD0iTSAwIDEwIEwgNDAgMTAgTSAxMCAwIEwgMTAgNDAgTSAwIDIwIEwgNDAgMjAgTSAyMCAwIEwgMjAgNDAgTSAwIDMwIEwgNDAgMzAgTSAzMCAwIEwgMzAgNDAiIGZpbGw9Im5vbmUiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS13aWR0aD0iMSIgb3BhY2l0eT0iMC4xIi8+PC9wYXR0ZXJuPjwvZGVmcz48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJ1cmwoI2dyaWQpIi8+PC9zdmc+')]"></div>
                </div>
                <div class="relative p-12 text-center">
                    <div class="inline-block mb-6">
                        <div class="bg-white text-purple-900 px-6 py-2 rounded-full font-bold text-sm shadow-lg">
                            <i class="fas fa-gift mr-2"></i>신규 파트너 특별 혜택
                        </div>
                    </div>
                    <h3 class="text-3xl md:text-5xl font-bold text-white mb-6 leading-tight">
                        지금 시작하면<br>
                        <span class="text-yellow-300">최대 500만원 혜택!</span> 🎁
                    </h3>
                    <p class="text-xl text-white mb-8 opacity-90 max-w-2xl mx-auto">
                        무료 상담으로 당신의 공방 창업 계획을 구체화하고<br>
                        맞춤형 창업 패키지를 받아보세요
                    </p>
                    
                    <!-- Benefits Pills -->
                    <div class="flex flex-wrap justify-center gap-3 mb-8">
                        <div class="bg-white/20 backdrop-blur-lg px-4 py-2 rounded-full text-white text-sm font-semibold">
                            <i class="fas fa-check mr-1"></i>1:1 맞춤 컨설팅
                        </div>
                        <div class="bg-white/20 backdrop-blur-lg px-4 py-2 rounded-full text-white text-sm font-semibold">
                            <i class="fas fa-check mr-1"></i>사업 계획서 작성
                        </div>
                        <div class="bg-white/20 backdrop-blur-lg px-4 py-2 rounded-full text-white text-sm font-semibold">
                            <i class="fas fa-check mr-1"></i>입지 분석 리포트
                        </div>
                        <div class="bg-white/20 backdrop-blur-lg px-4 py-2 rounded-full text-white text-sm font-semibold">
                            <i class="fas fa-check mr-1"></i>수익성 시뮬레이션
                        </div>
                    </div>
                    
                    <!-- Available Properties Section -->
                    <div class="mb-12">
                        <div class="text-center mb-8">
                            <h3 class="text-3xl md:text-4xl font-bold text-white mb-4">
                                <i class="fas fa-building mr-3 text-yellow-300"></i>
                                전국 공방 매물 보기
                            </h3>
                            <p class="text-xl text-purple-200">
                                아로마펄스가 엄선한 최적의 공방 공간을 확인하세요
                            </p>
                        </div>
                        
                        <!-- Region Filter -->
                        <div class="flex flex-wrap justify-center gap-3 mb-8">
                            <button onclick="filterProperties('all')" 
                                    class="region-filter active bg-white/20 backdrop-blur-lg px-6 py-3 rounded-full font-bold text-white hover:bg-white/30 transition border border-white/30"
                                    data-region="all">
                                <i class="fas fa-globe mr-2"></i>전체
                            </button>
                            <button onclick="filterProperties('서울')" 
                                    class="region-filter bg-white/10 backdrop-blur-lg px-6 py-3 rounded-full font-bold text-white hover:bg-white/20 transition border border-white/20"
                                    data-region="서울">
                                <i class="fas fa-building mr-2"></i>서울
                            </button>
                            <button onclick="filterProperties('경기')" 
                                    class="region-filter bg-white/10 backdrop-blur-lg px-6 py-3 rounded-full font-bold text-white hover:bg-white/20 transition border border-white/20"
                                    data-region="경기">
                                <i class="fas fa-city mr-2"></i>경기
                            </button>
                            <button onclick="filterProperties('부산')" 
                                    class="region-filter bg-white/10 backdrop-blur-lg px-6 py-3 rounded-full font-bold text-white hover:bg-white/20 transition border border-white/20"
                                    data-region="부산">
                                <i class="fas fa-water mr-2"></i>부산
                            </button>
                            <button onclick="filterProperties('대구')" 
                                    class="region-filter bg-white/10 backdrop-blur-lg px-6 py-3 rounded-full font-bold text-white hover:bg-white/20 transition border border-white/20"
                                    data-region="대구">
                                <i class="fas fa-mountain mr-2"></i>대구
                            </button>
                            <button onclick="filterProperties('기타')" 
                                    class="region-filter bg-white/10 backdrop-blur-lg px-6 py-3 rounded-full font-bold text-white hover:bg-white/20 transition border border-white/20"
                                    data-region="기타">
                                <i class="fas fa-map-marked-alt mr-2"></i>기타 지역
                            </button>
                        </div>
                        
                        <!-- Properties Grid -->
                        <div id="properties-grid" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                            <!-- Properties will be dynamically loaded here -->
                        </div>
                        
                        <!-- No Results Message -->
                        <div id="no-results" class="hidden text-center py-12">
                            <i class="fas fa-search text-6xl text-purple-300 mb-4"></i>
                            <p class="text-xl text-purple-200">해당 지역의 매물이 없습니다</p>
                            <p class="text-purple-300 mt-2">다른 지역을 선택해보세요</p>
                        </div>
                    </div>
                    
                    <div class="flex flex-col sm:flex-row gap-4 justify-center items-center">
                        <button onclick="location.href='mailto:support@wellthykorea.com?subject=무인 공방 확장 상담 신청'" 
                                class="bg-white text-purple-900 px-12 py-5 rounded-full text-lg font-bold hover:bg-gray-100 transition transform hover:scale-105 shadow-2xl flex items-center">
                            <i class="fas fa-envelope mr-3 text-xl"></i>
                            <div class="text-left">
                                <div>확장 상담 신청</div>
                                <div class="text-xs text-purple-600 font-normal">기존 운영자 전용</div>
                            </div>
                        </button>
                        <button onclick="openKakaoChannel()" 
                                class="bg-yellow-400 text-gray-900 px-12 py-5 rounded-full text-lg font-bold hover:bg-yellow-300 transition transform hover:scale-105 shadow-2xl flex items-center">
                            <i class="fab fa-kickstarter mr-3 text-xl"></i>
                            <div class="text-left">
                                <div>카카오톡 문의</div>
                                <div class="text-xs text-gray-700 font-normal">실시간 상담</div>
                            </div>
                        </button>
                    </div>
                    
                    <div class="mt-8 flex flex-col sm:flex-row items-center justify-center gap-6 text-white">
                        <div class="flex items-center">
                            <i class="fas fa-phone-alt mr-2"></i>
                            <span class="font-semibold">070-4233-5183</span>
                        </div>
                        <div class="hidden sm:block w-px h-6 bg-white/30"></div>
                        <div class="text-sm opacity-90">
                            평일 10:00-18:00 (점심 12:00-13:00)
                        </div>
                    </div>
                </div>
            </div>

            <!-- Testimonials -->
            <div class="mt-16">
                <h3 class="text-3xl font-bold text-white text-center mb-10">
                    <i class="fas fa-quote-left text-yellow-400 mr-3"></i>
                    무인 공방 확장에 성공한 사장님들의 이야기
                </h3>
                <div class="grid md:grid-cols-2 gap-8">
                    <!-- Testimonial 1 -->
                    <div class="bg-white bg-opacity-10 backdrop-blur-lg rounded-2xl p-8 border border-white border-opacity-20">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 bg-gradient-to-r from-yellow-400 to-pink-400 rounded-full flex items-center justify-center text-white font-bold text-xl mr-4">
                                이
                            </div>
                            <div>
                                <div class="text-white font-bold">이수진 대표</div>
                                <div class="text-purple-300 text-sm">서울 홍대 → 강남 2호점 확장</div>
                            </div>
                        </div>
                        <div class="text-yellow-400 mb-3">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                        </div>
                        <p class="text-purple-100 leading-relaxed">
                            "홍대에서 3년간 공방을 운영하면서 항상 인건비가 부담이었어요. 무인 시스템으로 강남에 2호점을 열었는데, 직원 없이도 안정적으로 운영되고 있어요! 우리 브랜드 컨셉도 그대로 살릴 수 있어서 최고예요. 매출은 2배, 스트레스는 반으로 줄었어요!"
                        </p>
                    </div>

                    <!-- Testimonial 2 -->
                    <div class="bg-white bg-opacity-10 backdrop-blur-lg rounded-2xl p-8 border border-white border-opacity-20">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 bg-gradient-to-r from-blue-400 to-teal-400 rounded-full flex items-center justify-center text-white font-bold text-xl mr-4">
                                박
                            </div>
                            <div>
                                <div class="text-white font-bold">박민수 대표</div>
                                <div class="text-purple-300 text-sm">부산 본점 → 대구/광주 3개 지점</div>
                            </div>
                        </div>
                        <div class="text-yellow-400 mb-3">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                        </div>
                        <p class="text-purple-100 leading-relaxed">
                            "8년간 쌓은 공방 노하우를 무인 시스템과 결합했더니 1년 만에 3개 지점으로 확장 성공! 각 지점마다 우리 인테리어 컨셉을 그대로 적용할 수 있어서 브랜드 이미지가 일관성 있게 유지돼요. 모바일 앱 하나로 모든 매장을 관리하니 정말 편합니다!"
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script>
        // Global Variables
        let currentUser = null;
        let map = null;
        let markers = [];
        let classes = []; // 원데이 클래스
        let currentInfoWindow = null; // 현재 열려있는 정보창

        // Check Login Status on Page Load
        async function checkLoginStatus() {
            try {
                console.log('[LOGIN] Checking login status...');
                const response = await fetch('/api/auth/me');
                console.log('[LOGIN] Response status:', response.status);
                
                const data = await response.json();
                console.log('[LOGIN] Response data:', data);

                if (data.authenticated) {
                    console.log('[LOGIN] User is authenticated:', data.user);
                    currentUser = data.user;
                    showLoggedInState();
                    await loadClassesAndMap();
                } else {
                    console.log('[LOGIN] User is not authenticated');
                    showLoginRequiredState();
                }
            } catch (error) {
                console.error('[LOGIN] Failed to check login status:', error);
                showLoginRequiredState();
            }
        }

        // Show Login Required Message
        function showLoginRequiredState() {
            document.getElementById('login-required-section').classList.remove('hidden');
            document.getElementById('user-info-section').classList.add('hidden');
            document.getElementById('maps-section').classList.add('hidden');
        }

        // Show Logged In State
        function showLoggedInState() {
            document.getElementById('login-required-section').classList.add('hidden');
            document.getElementById('user-info-section').classList.remove('hidden');
            
            // Update user info
            document.getElementById('user-name').textContent = currentUser.name;
            
            const platformMap = {
                'google': 'Google로 로그인',
                'naver': 'Naver로 로그인',
                'kakao': 'Kakao로 로그인'
            };
            document.getElementById('user-platform').textContent = platformMap[currentUser.provider] || currentUser.provider;
            
            // Update platform icon
            const iconMap = {
                'google': 'fa-google',
                'naver': 'fa-n',
                'kakao': 'fa-comment'
            };
            const icon = document.getElementById('user-platform-icon');
            icon.innerHTML = `<i class="fab ${iconMap[currentUser.provider] || 'fa-user'} text-purple-600 text-xl"></i>`;
        }

        // Load Classes and Initialize Map
        async function loadClassesAndMap() {
            try {
                // Fetch oneday classes from API
                console.log('Fetching classes from API...');
                const response = await fetch(`/api/oneday-classes?provider=${currentUser.provider}`);
                
                if (!response.ok) {
                    throw new Error(`API request failed: ${response.status} ${response.statusText}`);
                }
                
                classes = await response.json();
                console.log('Classes loaded:', classes.length, 'items');

                // Show maps section
                document.getElementById('maps-section').classList.remove('hidden');

                // Update map provider name
                const providerNames = {
                    'google': 'Google Maps',
                    'naver': 'Naver Map',
                    'kakao': 'Kakao Map'
                };
                document.getElementById('map-provider-name').textContent = providerNames[currentUser.provider] || 'Maps';

                // Initialize map based on provider
                console.log('Initializing map for provider:', currentUser.provider);
                await initializeMapByProvider();
            } catch (error) {
                console.error('Failed to load classes:', error);
                alert(`원데이 클래스 정보를 불러오는데 실패했습니다.\n\n오류: ${error.message || error}\n\n브라우저 콘솔(F12)에서 자세한 정보를 확인하세요.`);
            }
        }

        // Load Map API Script Dynamically
        async function loadMapAPI(provider) {
            try {
                console.log(`[MAP] Loading Map API for provider: ${provider}`);
                
                // Check if API is already loaded
                if (provider === 'google' && typeof google !== 'undefined' && google.maps) {
                    console.log('[MAP] Google Maps API already loaded');
                    return;
                }
                if (provider === 'naver' && typeof naver !== 'undefined' && naver.maps) {
                    console.log('[MAP] Naver Maps API already loaded');
                    return;
                }
                if (provider === 'kakao' && typeof kakao !== 'undefined' && kakao.maps) {
                    console.log('[MAP] Kakao Maps API already loaded');
                    return;
                }
                
                // Check if script tag already exists
                const existingScript = document.querySelector(`script[data-map-provider="${provider}"]`);
                if (existingScript) {
                    console.log(`[MAP] ${provider} Maps script tag already exists, waiting for load...`);
                    return;
                }
                
                // Fetch map configuration from server
                console.log(`[MAP] Fetching map config for ${provider}...`);
                const response = await fetch(`/api/map-config?provider=${provider}`);
                if (!response.ok) {
                    throw new Error(`Failed to load map config: ${response.status}`);
                }
                
                const config = await response.json();
                console.log(`[MAP] Map config loaded:`, config);
                
                // Load the appropriate script
                return new Promise((resolve, reject) => {
                    const script = document.createElement('script');
                    script.src = config.config.mapUrl;
                    script.async = true;
                    script.defer = true;
                    script.setAttribute('data-map-provider', provider);
                    
                    script.onload = () => {
                        console.log(`[MAP] ${provider} Maps API loaded successfully`);
                        resolve();
                    };
                    
                    script.onerror = () => {
                        console.error(`[MAP] Failed to load ${provider} Maps API`);
                        reject(new Error(`Failed to load ${provider} Maps API`));
                    };
                    
                    console.log(`[MAP] Appending script tag for ${provider}:`, script.src);
                    document.head.appendChild(script);
                });
            } catch (error) {
                console.error(`[MAP] Error loading Map API:`, error);
                throw error;
            }
        }

        // Initialize Map by Provider
        async function initializeMapByProvider() {
            // Load Map API first
            await loadMapAPI(currentUser.provider);
            
            // Then initialize the map
            if (currentUser.provider === 'google') {
                await initializeGoogleMap();
            } else if (currentUser.provider === 'naver') {
                await initializeNaverMap();
            } else if (currentUser.provider === 'kakao') {
                await initializeKakaoMap();
            }
        }

        // Initialize Google Maps
        async function initializeGoogleMap() {
            // Wait for Google Maps API to load
            if (typeof google === 'undefined' || typeof google.maps === 'undefined') {
                console.log('Waiting for Google Maps API to load...');
                await new Promise((resolve) => {
                    const checkInterval = setInterval(() => {
                        if (typeof google !== 'undefined' && typeof google.maps !== 'undefined') {
                            clearInterval(checkInterval);
                            resolve();
                        }
                    }, 100);
                    
                    // Timeout after 10 seconds
                    setTimeout(() => {
                        clearInterval(checkInterval);
                        throw new Error('Google Maps API failed to load within 10 seconds');
                    }, 10000);
                });
            }
            
            document.getElementById('map-loading').classList.add('hidden');

            const center = { lat: 37.5665, lng: 126.9780 };

            map = new google.maps.Map(document.getElementById('map'), {
                center: center,
                zoom: 12,
                styles: [
                    {
                        featureType: 'poi',
                        elementType: 'labels',
                        stylers: [{ visibility: 'off' }]
                    }
                ]
            });

            // Add markers
            classes.forEach(cls => {
                if (cls.latitude && cls.longitude) {
                    const marker = new google.maps.Marker({
                        position: { lat: cls.latitude, lng: cls.longitude },
                        map: map,
                        title: cls.name,
                        icon: {
                            path: google.maps.SymbolPath.CIRCLE,
                            scale: 10,
                            fillColor: '#9333EA',
                            fillOpacity: 1,
                            strokeColor: '#ffffff',
                            strokeWeight: 2,
                        }
                    });

                    const infoWindow = new google.maps.InfoWindow({
                        content: createInfoWindowContent(cls)
                    });

                    marker.addListener('click', () => {
                        markers.forEach(m => m.infoWindow && m.infoWindow.close());
                        infoWindow.open(map, marker);
                    });

                    marker.infoWindow = infoWindow;
                    markers.push(marker);
                }
            });

            loadClassesList();

            if (classes.length > 0 && classes[0].latitude) {
                map.setCenter({ lat: classes[0].latitude, lng: classes[0].longitude });
            }
        }

        // Initialize Naver Map
        async function initializeNaverMap() {
            try {
                console.log('[NAVER] Starting Naver Maps initialization...');
                
                // Wait for naver.maps to be available (loaded by loadMapAPI)
                if (typeof naver === 'undefined' || !naver.maps) {
                    console.log('[NAVER] Waiting for Naver Maps API to load...');
                    await new Promise((resolve, reject) => {
                        let attempts = 0;
                        const checkInterval = setInterval(() => {
                            attempts++;
                            console.log(`[NAVER] Checking API availability... Attempt ${attempts}`);
                            if (typeof naver !== 'undefined' && naver.maps) {
                                console.log('[NAVER] Naver Maps API is now available!');
                                clearInterval(checkInterval);
                                resolve();
                            }
                        }, 100);
                        
                        // Timeout after 10 seconds
                        setTimeout(() => {
                            clearInterval(checkInterval);
                            reject(new Error('Naver Maps API failed to load within 10 seconds'));
                        }, 10000);
                    });
                }
                
                console.log('[NAVER] Hiding loading overlay...');
                document.getElementById('map-loading').classList.add('hidden');
                
                // Initialize map center
                const center = classes.length > 0 && classes[0].latitude 
                    ? new naver.maps.LatLng(classes[0].latitude, classes[0].longitude)
                    : new naver.maps.LatLng(37.5665, 126.9780); // Default: Seoul
                
                console.log('[NAVER] Creating map with center:', center.toString());
                
                // Create Naver Map
                map = new naver.maps.Map('map', {
                    center: center,
                    zoom: 12,
                    zoomControl: true,
                    zoomControlOptions: {
                        position: naver.maps.Position.TOP_RIGHT
                    }
                });
                
                console.log('[NAVER] Map created successfully:', map);
                
                // Add markers
                console.log(`[NAVER] Adding ${classes.length} markers...`);
                classes.forEach((cls, index) => {
                    if (cls.latitude && cls.longitude) {
                        console.log(`[NAVER] Adding marker ${index + 1}:`, cls.name, cls.latitude, cls.longitude);
                        const position = new naver.maps.LatLng(cls.latitude, cls.longitude);
                        const marker = new naver.maps.Marker({
                            position: position,
                            map: map,
                            title: cls.name || cls.title,
                            icon: {
                                content: `<div style="background: #9333EA; width: 24px; height: 24px; border-radius: 50%; border: 3px solid white; box-shadow: 0 2px 6px rgba(0,0,0,0.3);"></div>`,
                                anchor: new naver.maps.Point(12, 12)
                            }
                        });
                        
                        const infoWindow = new naver.maps.InfoWindow({
                            content: createInfoWindowContent(cls),
                            borderWidth: 0,
                            backgroundColor: 'transparent',
                            disableAnchor: true,
                            pixelOffset: new naver.maps.Point(0, -10)
                        });
                        
                        naver.maps.Event.addListener(marker, 'click', function() {
                            console.log('[NAVER] Marker clicked:', cls.name);
                            if (currentInfoWindow) {
                                currentInfoWindow.close();
                            }
                            infoWindow.open(map, marker);
                            currentInfoWindow = infoWindow;
                        });
                        
                        markers.push({ marker, infoWindow });
                    }
                });
                
                console.log('[NAVER] Loading classes list...');
                loadClassesList();
                
                if (classes.length > 0 && classes[0].latitude) {
                    console.log('[NAVER] Setting map center to first class location');
                    map.setCenter(new naver.maps.LatLng(classes[0].latitude, classes[0].longitude));
                }
                
                console.log('[NAVER] Naver Maps initialization complete!');
            } catch (error) {
                console.error('[NAVER] Naver Maps initialization error:', error);
                document.getElementById('map-loading').innerHTML = `
                    <div class="text-center">
                        <i class="fas fa-exclamation-triangle text-red-500 text-4xl mb-4"></i>
                        <p class="text-gray-700 font-semibold mb-2">지도 로드 실패</p>
                        <p class="text-gray-500 text-sm">${error.message}</p>
                        <p class="text-gray-400 text-xs mt-2">브라우저 콘솔(F12)에서 자세한 정보를 확인하세요</p>
                    </div>
                `;
                loadClassesList();
            }
        }

        // Initialize Kakao Map
        async function initializeKakaoMap() {
            try {
                // Wait for kakao.maps to be available (loaded by loadMapAPI)
                if (typeof kakao === 'undefined' || !kakao.maps) {
                    console.log('Waiting for Kakao Maps API to load...');
                    await new Promise((resolve, reject) => {
                        const checkInterval = setInterval(() => {
                            if (typeof kakao !== 'undefined' && kakao.maps) {
                                clearInterval(checkInterval);
                                resolve();
                            }
                        }, 100);
                        
                        // Timeout after 10 seconds
                        setTimeout(() => {
                            clearInterval(checkInterval);
                            reject(new Error('Kakao Maps API failed to load within 10 seconds'));
                        }, 10000);
                    });
                }
                
                // Load Kakao Maps
                kakao.maps.load(() => {
                    document.getElementById('map-loading').classList.add('hidden');
                    
                    // Initialize map center
                    const center = classes.length > 0 && classes[0].latitude 
                        ? new kakao.maps.LatLng(classes[0].latitude, classes[0].longitude)
                        : new kakao.maps.LatLng(37.5665, 126.9780); // Default: Seoul
                    
                    // Create Kakao Map
                    map = new kakao.maps.Map(document.getElementById('map'), {
                        center: center,
                        level: 5
                    });
                    
                    // Add markers
                    classes.forEach(cls => {
                        if (cls.latitude && cls.longitude) {
                            const position = new kakao.maps.LatLng(cls.latitude, cls.longitude);
                            const marker = new kakao.maps.Marker({
                                position: position,
                                map: map,
                                title: cls.name || cls.title,
                                image: new kakao.maps.MarkerImage(
                                    'data:image/svg+xml;base64,' + btoa(`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"><circle cx="12" cy="12" r="12" fill="#9333EA" stroke="white" stroke-width="3"/></svg>`),
                                    new kakao.maps.Size(24, 24)
                                )
                            });
                            
                            const infoWindow = new kakao.maps.InfoWindow({
                                content: createInfoWindowContent(cls)
                            });
                            
                            kakao.maps.event.addListener(marker, 'click', function() {
                                if (currentInfoWindow) {
                                    currentInfoWindow.close();
                                }
                                infoWindow.open(map, marker);
                                currentInfoWindow = infoWindow;
                            });
                            
                            markers.push({ marker, infoWindow });
                        }
                    });
                    
                    loadClassesList();
                    
                    if (classes.length > 0 && classes[0].latitude) {
                        map.setCenter(new kakao.maps.LatLng(classes[0].latitude, classes[0].longitude));
                    }
                });
            } catch (error) {
                console.error('Kakao Maps initialization error:', error);
                document.getElementById('map-loading').innerHTML = `
                    <div class="text-center">
                        <i class="fas fa-exclamation-triangle text-red-500 text-4xl mb-4"></i>
                        <p class="text-gray-700 font-semibold mb-2">지도 로드 실패</p>
                        <p class="text-gray-500 text-sm">${error.message}</p>
                    </div>
                `;
                loadClassesList();
            }
        }

        // Create Info Window Content
        function createInfoWindowContent(cls) {
            const bookingUrl = getBookingUrl(cls);
            return `
                <div style="max-width: 300px; padding: 10px;">
                    <h3 style="font-size: 18px; font-weight: bold; margin-bottom: 8px; color: #1f2937;">
                        ${cls.name || cls.title}
                    </h3>
                    <p style="font-size: 14px; color: #6b7280; margin-bottom: 8px;">
                        <i class="fas fa-map-marker-alt"></i> ${cls.location || '주소 정보 없음'}
                    </p>
                    ${cls.description ? `<p style="font-size: 13px; color: #9ca3af; margin-bottom: 12px;">${cls.description}</p>` : ''}
                    <button onclick="bookClass(${cls.id}, '${bookingUrl}')" style="background: linear-gradient(to right, #9333ea, #db2777); color: white; padding: 10px 20px; border-radius: 8px; font-weight: bold; width: 100%; border: none; cursor: pointer;">
                        <i class="fas fa-calendar-check"></i> 예약하기
                    </button>
                </div>
            `;
        }

        // Get Booking URL based on provider
        function getBookingUrl(cls) {
            if (currentUser.provider === 'google') {
                // Google Reserve link (if available)
                return cls.google_place_id ? `https://www.google.com/maps/place/?q=place_id:${cls.google_place_id}` : '#';
            } else if (currentUser.provider === 'naver') {
                // Naver Smart Place link (if available)
                return cls.naver_place_id ? `https://m.place.naver.com/place/${cls.naver_place_id}` : '#';
            } else if (currentUser.provider === 'kakao') {
                // Kakao Place link (if available)
                return cls.kakao_place_id ? `https://place.map.kakao.com/${cls.kakao_place_id}` : '#';
            }
            return '#';
        }

        // Load Classes List
        function loadClassesList() {
            const listContainer = document.getElementById('workshops-list');
            
            if (classes.length === 0) {
                listContainer.innerHTML = `
                    <div class="col-span-full text-center py-12">
                        <i class="fas fa-exclamation-circle text-6xl text-gray-300 mb-4"></i>
                        <p class="text-gray-500 text-lg">등록된 원데이 클래스가 없습니다.</p>
                    </div>
                `;
                return;
            }

            // 거리별로 그룹화
            const nearbyClasses = classes.filter(cls => cls.distance && cls.distance <= 20);
            const mediumClasses = classes.filter(cls => cls.distance && cls.distance > 20 && cls.distance <= 50);
            const sameRegionClasses = classes.filter(cls => cls.distance === 999); // 좌표 없지만 같은 지역
            const farClasses = classes.filter(cls => (!cls.distance || cls.distance > 50) && cls.distance !== 999);
            
            let html = '';
            
            // 20km 이내 (가까운 지역)
            if (nearbyClasses.length > 0) {
                html += `
                    <div class="col-span-full mb-4">
                        <h3 class="text-lg font-bold text-gray-800 flex items-center">
                            <i class="fas fa-location-arrow text-green-600 mr-2"></i>
                            가까운 지역 (20km 이내) - ${nearbyClasses.length}개
                        </h3>
                    </div>
                `;
                html += nearbyClasses.map(cls => renderClassCard(cls)).join('');
            }
            
            // 20-50km (인근 지역)
            if (mediumClasses.length > 0) {
                html += `
                    <div class="col-span-full mb-4 mt-8">
                        <h3 class="text-lg font-bold text-gray-800 flex items-center">
                            <i class="fas fa-map-marked-alt text-blue-600 mr-2"></i>
                            인근 지역 (20-50km) - ${mediumClasses.length}개
                        </h3>
                    </div>
                `;
                html += mediumClasses.map(cls => renderClassCard(cls)).join('');
            }
            
            // 같은 지역 (좌표 없지만 지역명 일치)
            if (sameRegionClasses.length > 0) {
                html += `
                    <div class="col-span-full mb-4 mt-8">
                        <h3 class="text-lg font-bold text-gray-800 flex items-center">
                            <i class="fas fa-map-marker-alt text-purple-600 mr-2"></i>
                            같은 지역 (수도권) - ${sameRegionClasses.length}개
                        </h3>
                        <p class="text-sm text-gray-500 mt-1">
                            <i class="fas fa-info-circle mr-1"></i>
                            정확한 거리 정보가 없지만, 같은 지역권에 위치한 공방입니다.
                        </p>
                    </div>
                `;
                html += sameRegionClasses.map(cls => renderClassCard(cls)).join('');
            }
            
            // 거리 정보 없거나 50km 이상
            if (farClasses.length > 0) {
                html += `
                    <div class="col-span-full mb-4 mt-8">
                        <h3 class="text-lg font-bold text-gray-800 flex items-center">
                            <i class="fas fa-globe text-gray-600 mr-2"></i>
                            기타 지역 - ${farClasses.length}개
                        </h3>
                    </div>
                `;
                html += farClasses.map(cls => renderClassCard(cls)).join('');
            }
            
            listContainer.innerHTML = html;
        }
        
        // 클래스 카드 렌더링 함수
        function renderClassCard(cls) {
            const bookingUrl = getBookingUrl(cls);
            
            // 거리 배지 생성
            let distanceBadge = '';
            if (cls.distance) {
                if (cls.distance === 999) {
                    // 같은 지역 (좌표 없음)
                    distanceBadge = `
                        <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800">
                            <i class="fas fa-map-marker-alt mr-1"></i>
                            같은 지역
                        </span>
                    `;
                } else {
                    let badgeColor = 'bg-green-100 text-green-800';
                    let icon = 'fa-walking';
                    
                    if (cls.distance <= 5) {
                        badgeColor = 'bg-green-100 text-green-800';
                        icon = 'fa-walking';
                    } else if (cls.distance <= 20) {
                        badgeColor = 'bg-blue-100 text-blue-800';
                        icon = 'fa-car';
                    } else if (cls.distance <= 50) {
                        badgeColor = 'bg-orange-100 text-orange-800';
                        icon = 'fa-bus';
                    } else {
                        badgeColor = 'bg-gray-100 text-gray-800';
                        icon = 'fa-train';
                    }
                    
                    distanceBadge = `
                        <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ${badgeColor}">
                            <i class="fas ${icon} mr-1"></i>
                            ${cls.distance.toFixed(1)}km
                        </span>
                    `;
                }
            }
            
            return `
                <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-2xl transition cursor-pointer" 
                     onclick="focusClass(${cls.id})">
                    <div class="p-6">
                        <div class="flex items-start justify-between mb-2">
                            <h4 class="text-xl font-bold text-gray-900 flex-1">${cls.name || cls.title}</h4>
                            ${distanceBadge}
                        </div>
                        <p class="text-sm text-gray-600 mb-3 flex items-start">
                            <i class="fas fa-map-marker-alt text-purple-600 mr-2 mt-1"></i>
                            <span>${cls.location || '주소 정보 없음'}</span>
                        </p>
                        ${cls.description ? `<p class="text-sm text-gray-500 mb-4 line-clamp-2">${cls.description}</p>` : ''}
                        ${cls.price ? `<p class="text-lg font-bold text-purple-600 mb-3">${cls.price.toLocaleString()}원</p>` : ''}
                        <button onclick="event.stopPropagation(); bookClass(${cls.id}, '${bookingUrl}')" 
                                class="w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white px-4 py-3 rounded-lg font-bold hover:shadow-lg transition">
                            <i class="fas fa-calendar-check mr-2"></i>예약하기
                        </button>
                    </div>
                </div>
            `;
        }

        // Focus on Class Marker
        function focusClass(classId) {
            const cls = classes.find(c => c.id === classId);
            if (cls && cls.latitude && cls.longitude && map) {
                map.setCenter({ lat: cls.latitude, lng: cls.longitude });
                map.setZoom(15);
                
                const markerIndex = classes.findIndex(c => c.id === classId);
                if (markerIndex >= 0 && markers[markerIndex]) {
                    google.maps.event.trigger(markers[markerIndex], 'click');
                }
            }
        }

        // Book Class
        // Open booking modal
        function bookClass(classId, bookingUrl) {
            const cls = classes.find(c => c.id === classId);
            if (!cls) return;
            
            // Show booking modal
            document.getElementById('booking-modal').classList.remove('hidden');
            document.getElementById('booking-class-title').textContent = cls.title || cls.name;
            document.getElementById('booking-class-info').textContent = `${cls.location} · ${cls.price?.toLocaleString()}원`;
            document.getElementById('booking-class-id').value = classId;
            
            // Prefill user info
            document.getElementById('booker-name').value = currentUser.name;
            document.getElementById('booker-email').value = currentUser.email;
        }

        // Close booking modal
        function closeBookingModal() {
            document.getElementById('booking-modal').classList.add('hidden');
            document.getElementById('booking-form').reset();
        }

        // Submit booking
        async function submitBooking(event) {
            event.preventDefault();
            
            const classId = document.getElementById('booking-class-id').value;
            const bookingDate = document.getElementById('booking-date').value;
            const bookingTime = document.getElementById('booking-time').value;
            const participants = document.getElementById('participants').value;
            const bookerName = document.getElementById('booker-name').value;
            const bookerPhone = document.getElementById('booker-phone').value;
            const bookerEmail = document.getElementById('booker-email').value;
            
            // Combine date and time
            const bookingDatetime = `${bookingDate}T${bookingTime}:00`;
            
            try {
                const response = await fetch(`/api/bookings/oneday-classes/${classId}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        booking_date: bookingDatetime,
                        participants: parseInt(participants),
                        booker_name: bookerName,
                        booker_phone: bookerPhone,
                        booker_email: bookerEmail
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    closeBookingModal();
                    showBookingSuccess(data.booking);
                } else {
                    const error = await response.json();
                    alert(error.error || '예약에 실패했습니다.');
                }
            } catch (error) {
                console.error('Booking error:', error);
                alert('예약 처리 중 오류가 발생했습니다.');
            }
        }

        // Show booking success modal
        function showBookingSuccess(booking) {
            document.getElementById('success-modal').classList.remove('hidden');
            document.getElementById('success-booking-id').textContent = booking.id;
            document.getElementById('icalendar-link').href = `/api/bookings/${booking.id}/icalendar`;
        }

        // Close success modal
        function closeSuccessModal() {
            document.getElementById('success-modal').classList.add('hidden');
        }

        // Logout Function
        function logout() {
            window.location.href = '/auth/logout';
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', checkLoginStatus);

        // 매물 데이터 (수익 공유 모델)
        const properties = [
            {
                id: 1,
                region: '서울',
                district: '강남구',
                address: '서울특별시 강남구 테헤란로 123',
                size: '22평',
                floor: '2층',
                features: ['역세권', '주차가능', '신축건물'],
                image: 'https://via.placeholder.com/400x300/667eea/ffffff?text=강남+공방',
                status: 'available',
                description: '강남역 3분 거리, 유동인구가 많은 최적의 입지'
            },
            {
                id: 2,
                region: '서울',
                district: '홍대',
                address: '서울특별시 마포구 와우산로 29길 45',
                size: '18평',
                floor: '1층',
                features: ['홍대입구역', '1층 매장', '젊은층 밀집'],
                image: 'https://via.placeholder.com/400x300/764ba2/ffffff?text=홍대+공방',
                status: 'available',
                description: '홍대 예술의 거리, 트렌디한 공간'
            },
            {
                id: 3,
                region: '경기',
                district: '성남시',
                address: '경기도 성남시 분당구 정자일로 95',
                size: '25평',
                floor: '지상 1층',
                features: ['분당선 정자역', '주차 3대', '넓은 공간'],
                image: 'https://via.placeholder.com/400x300/f093fb/ffffff?text=분당+공방',
                status: 'available',
                description: '여유로운 공간, 가족 단위 고객 유입 우수'
            },
            {
                id: 4,
                region: '부산',
                district: '해운대구',
                address: '부산광역시 해운대구 센텀중앙로 78',
                size: '20평',
                floor: '3층',
                features: ['센텀시티', '오션뷰', '신축'],
                image: 'https://via.placeholder.com/400x300/64b5f6/ffffff?text=해운대+공방',
                status: 'reserved',
                description: '바다가 보이는 힐링 공간, 관광객 유입 가능'
            },
            {
                id: 5,
                region: '대구',
                district: '수성구',
                address: '대구광역시 수성구 범어동 1234',
                size: '19평',
                floor: '2층',
                features: ['범어역', '주차가능', '조용한 분위기'],
                image: 'https://via.placeholder.com/400x300/81c784/ffffff?text=대구+공방',
                status: 'available',
                description: '고급 주거지역, 안정적인 고객층'
            },
            {
                id: 6,
                region: '경기',
                district: '수원시',
                address: '경기도 수원시 영통구 광교중앙로 170',
                size: '23평',
                floor: '1층',
                features: ['광교신도시', '1층', '대로변'],
                image: 'https://via.placeholder.com/400x300/ff8a65/ffffff?text=광교+공방',
                status: 'available',
                description: '신도시 중심가, 신규 거주민 밀집 지역'
            }
        ];
        
        let currentFilter = 'all';
        
        function openKakaoChannel() {
            // 카카오톡 채널 연결 (실제 채널 URL로 교체 필요)
            window.open('https://pf.kakao.com/your-channel-id', '_blank');
            // 또는 1:1 채팅 링크
            // window.open('http://qr.kakao.com/talk/your-code', '_blank');
        }
        
        function loadProperties() {
            const grid = document.getElementById('properties-grid');
            const noResults = document.getElementById('no-results');
            
            const filteredProperties = currentFilter === 'all' 
                ? properties 
                : properties.filter(p => p.region === currentFilter);
            
            if (filteredProperties.length === 0) {
                grid.innerHTML = '';
                noResults.classList.remove('hidden');
                return;
            }
            
            noResults.classList.add('hidden');
            
            grid.innerHTML = filteredProperties.map(property => `
                <div class="category-card bg-white rounded-2xl overflow-hidden shadow-xl">
                    <!-- Property Image -->
                    <div class="relative h-48 overflow-hidden">
                        <img src="${property.image}" alt="${property.district}" class="w-full h-full object-cover">
                        <div class="absolute top-4 left-4">
                            <span class="bg-gradient-to-r from-purple-600 to-pink-600 text-white px-4 py-2 rounded-full text-sm font-bold shadow-lg">
                                ${property.region} · ${property.district}
                            </span>
                        </div>
                        <div class="absolute top-4 right-4">
                            ${property.status === 'available' 
                                ? '<span class="bg-green-500 text-white px-3 py-1 rounded-full text-xs font-bold">입주 가능</span>'
                                : '<span class="bg-gray-500 text-white px-3 py-1 rounded-full text-xs font-bold">예약 완료</span>'
                            }
                        </div>
                    </div>
                    
                    <!-- Property Info -->
                    <div class="p-6">
                        <h4 class="text-xl font-bold text-gray-900 mb-2">${property.district} 무인 공방</h4>
                        <p class="text-gray-600 text-sm mb-4 flex items-start">
                            <i class="fas fa-map-marker-alt text-purple-600 mr-2 mt-1"></i>
                            <span>${property.address}</span>
                        </p>
                        
                        <!-- Features -->
                        <div class="flex flex-wrap gap-2 mb-4">
                            ${property.features.map(feature => `
                                <span class="bg-purple-50 text-purple-700 px-3 py-1 rounded-full text-xs font-semibold">
                                    ${feature}
                                </span>
                            `).join('')}
                        </div>
                        
                        <!-- Details Grid -->
                        <div class="grid grid-cols-2 gap-3 mb-4 p-4 bg-gray-50 rounded-xl">
                            <div>
                                <div class="text-gray-500 text-xs mb-1">평수</div>
                                <div class="font-bold text-gray-900">${property.size}</div>
                            </div>
                            <div>
                                <div class="text-gray-500 text-xs mb-1">층수</div>
                                <div class="font-bold text-gray-900">${property.floor}</div>
                            </div>
                        </div>
                        
                        <!-- Revenue Share Consultation Notice -->
                        <div class="bg-gradient-to-r from-purple-50 to-pink-50 p-3 rounded-xl mb-4 border border-purple-200">
                            <p class="text-purple-700 text-sm font-semibold text-center">
                                <i class="fas fa-handshake mr-2"></i>수익 배분율은 상담 시 안내해드립니다
                            </p>
                        </div>
                        
                        <!-- Zero Cost Highlight -->
                        <div class="grid grid-cols-2 gap-3 mb-4">
                            <div class="bg-gradient-to-r from-green-50 to-teal-50 p-3 rounded-xl text-center border border-green-200">
                                <div class="text-green-600 text-xs mb-1">보증금</div>
                                <div class="font-bold text-green-700 text-lg">0원 ✨</div>
                            </div>
                            <div class="bg-gradient-to-r from-green-50 to-teal-50 p-3 rounded-xl text-center border border-green-200">
                                <div class="text-green-600 text-xs mb-1">월세</div>
                                <div class="font-bold text-green-700 text-lg">0원 ✨</div>
                            </div>
                        </div>
                        
                        <!-- Description -->
                        <p class="text-gray-600 text-sm mb-4 leading-relaxed">
                            ${property.description}
                        </p>
                        
                        <!-- Action Buttons -->
                        <div class="flex gap-2">
                            <button onclick="showPropertyDetail(${property.id})" 
                                    class="flex-1 bg-gradient-to-r from-purple-600 to-pink-600 text-white px-4 py-3 rounded-lg font-bold hover:shadow-lg transition">
                                <i class="fas fa-info-circle mr-2"></i>상세보기
                            </button>
                            <button onclick="contactAboutProperty(${property.id})" 
                                    class="flex-1 bg-gradient-to-r from-yellow-400 to-orange-500 text-white px-4 py-3 rounded-lg font-bold hover:shadow-lg transition">
                                <i class="fas fa-phone mr-2"></i>문의하기
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        function filterProperties(region) {
            currentFilter = region;
            
            // Update active button
            document.querySelectorAll('.region-filter').forEach(btn => {
                btn.classList.remove('active', 'bg-white/20', 'border-white/30');
                btn.classList.add('bg-white/10', 'border-white/20');
            });
            
            const activeBtn = document.querySelector(`[data-region="${region}"]`);
            activeBtn.classList.add('active', 'bg-white/20', 'border-white/30');
            activeBtn.classList.remove('bg-white/10', 'border-white/20');
            
            loadProperties();
        }
        
        function showPropertyDetail(propertyId) {
            const property = properties.find(p => p.id === propertyId);
            if (!property) return;
            
            // 상세 정보 모달 표시
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4 overflow-y-auto';
            modal.innerHTML = `
                <div class="bg-white rounded-3xl max-w-2xl w-full my-8 animate-scale-in shadow-2xl">
                    <div class="relative">
                        <img src="${property.image}" alt="${property.district}" class="w-full h-64 object-cover rounded-t-3xl">
                        <button onclick="this.closest('.fixed').remove()" 
                                class="absolute top-4 right-4 bg-white rounded-full w-10 h-10 flex items-center justify-center hover:bg-gray-100 transition">
                            <i class="fas fa-times text-gray-700"></i>
                        </button>
                    </div>
                    
                    <div class="p-8">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-3xl font-bold text-gray-900">${property.district} 무인 공방</h3>
                            ${property.status === 'available' 
                                ? '<span class="bg-green-500 text-white px-4 py-2 rounded-full text-sm font-bold">입주 가능</span>'
                                : '<span class="bg-gray-500 text-white px-4 py-2 rounded-full text-sm font-bold">예약 완료</span>'
                            }
                        </div>
                        
                        <div class="space-y-6">
                            <!-- Address -->
                            <div class="flex items-start">
                                <i class="fas fa-map-marker-alt text-purple-600 text-xl mr-4 mt-1"></i>
                                <div>
                                    <div class="font-semibold text-gray-700 mb-1">주소</div>
                                    <div class="text-gray-900">${property.address}</div>
                                </div>
                            </div>
                            
                            <!-- Details Grid -->
                            <div class="grid grid-cols-2 gap-4 mb-4">
                                <div class="bg-purple-50 p-4 rounded-xl">
                                    <div class="text-purple-600 text-sm mb-1">평수</div>
                                    <div class="text-2xl font-bold text-gray-900">${property.size}</div>
                                </div>
                                <div class="bg-pink-50 p-4 rounded-xl">
                                    <div class="text-pink-600 text-sm mb-1">층수</div>
                                    <div class="text-2xl font-bold text-gray-900">${property.floor}</div>
                                </div>
                            </div>
                            
                            <!-- Zero Cost Highlight -->
                            <div class="bg-gradient-to-r from-green-500 to-teal-500 p-6 rounded-xl mb-4">
                                <div class="text-center">
                                    <div class="text-white text-lg font-bold mb-3">💰 수익 공유 모델</div>
                                    <div class="grid grid-cols-2 gap-4">
                                        <div class="bg-white/20 backdrop-blur-lg rounded-lg p-3">
                                            <div class="text-white text-xs mb-1">보증금</div>
                                            <div class="text-white text-2xl font-bold">0원</div>
                                        </div>
                                        <div class="bg-white/20 backdrop-blur-lg rounded-lg p-3">
                                            <div class="text-white text-xs mb-1">월세</div>
                                            <div class="text-white text-2xl font-bold">0원</div>
                                        </div>
                                    </div>
                                    <div class="text-white text-sm mt-3 bg-white/10 backdrop-blur-lg rounded-lg p-3">
                                        <i class="fas fa-handshake mr-2"></i>상담을 통해 맞춤 수익 배분율을 안내해드립니다
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Features -->
                            <div>
                                <div class="font-semibold text-gray-700 mb-3">주요 특징</div>
                                <div class="flex flex-wrap gap-2">
                                    ${property.features.map(feature => `
                                        <span class="bg-purple-100 text-purple-700 px-4 py-2 rounded-full text-sm font-semibold">
                                            <i class="fas fa-check mr-2"></i>${feature}
                                        </span>
                                    `).join('')}
                                </div>
                            </div>
                            
                            <!-- Description -->
                            <div>
                                <div class="font-semibold text-gray-700 mb-3">매물 설명</div>
                                <p class="text-gray-600 leading-relaxed">${property.description}</p>
                            </div>
                            
                            <!-- Contact Button -->
                            <button onclick="contactAboutProperty(${property.id}); this.closest('.fixed').remove();" 
                                    class="w-full bg-gradient-to-r from-yellow-400 via-pink-500 to-purple-500 text-white px-8 py-4 rounded-full text-lg font-bold hover:shadow-2xl transition transform hover:scale-105">
                                <i class="fas fa-phone-alt mr-2"></i>이 매물 문의하기
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // 모달 외부 클릭 시 닫기
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.remove();
                }
            });
        }
        
        function contactAboutProperty(propertyId) {
            const property = properties.find(p => p.id === propertyId);
            if (!property) return;
            
            const subject = encodeURIComponent(`[매물 문의] ${property.district} 무인 공방 - 수익 공유 모델`);
            const body = encodeURIComponent(
                `매물 정보:\n` +
                `- 위치: ${property.address}\n` +
                `- 평수: ${property.size}\n` +
                `- 층수: ${property.floor}\n\n` +
                `💰 수익 공유 모델:\n` +
                `- 보증금: 0원 (ZERO)\n` +
                `- 월세: 0원 (ZERO)\n` +
                `- 수익 배분: 상담 시 맞춤 안내\n\n` +
                `문의 내용:\n` +
                `(여기에 문의 내용을 작성해주세요)\n\n` +
                `연락처:\n` +
                `이름: \n` +
                `전화번호: \n` +
                `이메일: \n` +
                `현재 운영 중인 공방: \n`
            );
            
            window.location.href = `mailto:support@wellthykorea.com?subject=${subject}&body=${body}`;
        }
        
        // 현재 위치 사용하여 지도 업데이트
        async function useCurrentLocationForMap() {
            // 위치 권한 지원 확인
            if (!navigator.geolocation) {
                alert('이 브라우저는 위치 서비스를 지원하지 않습니다.');
                return;
            }

            // 로딩 표시
            const button = event.target.closest('button');
            const originalHTML = button.innerHTML;
            button.disabled = true;
            button.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>위치 확인 중...';

            try {
                console.log('📍 [Healing Map] 위치 권한 요청 중...');
                
                // 위치 권한 요청
                const position = await new Promise((resolve, reject) => {
                    navigator.geolocation.getCurrentPosition(resolve, reject, {
                        enableHighAccuracy: true,
                        timeout: 10000,
                        maximumAge: 0
                    });
                });

                const latitude = position.coords.latitude;
                const longitude = position.coords.longitude;
                const accuracy = position.coords.accuracy;

                console.log(`✅ [Healing Map] 위치 획득: lat=${latitude}, lng=${longitude}, accuracy=${accuracy}m`);

                // 서버에 위치 정보 전송
                const response = await fetch('/api/user/location', {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    credentials: 'include', // ✅ 쿠키(인증토큰) 포함
                    body: JSON.stringify({
                        latitude: latitude,
                        longitude: longitude
                    })
                });

                if (!response.ok) {
                    let errorMsg = '위치 업데이트 실패';
                    try {
                        const error = await response.json();
                        errorMsg = error.error || errorMsg;
                    } catch (e) {
                        errorMsg = `HTTP ${response.status}: ${response.statusText}`;
                    }
                    console.error('❌ [Location Update] Server error:', errorMsg);
                    throw new Error(errorMsg);
                }

                const result = await response.json();
                console.log('✅ [Healing Map] 서버 위치 업데이트 성공:', result);

                // 인근 공방만 표시하도록 API 재호출
                alert(`✅ 현재 위치가 저장되었습니다!\n\n인근 공방을 검색합니다...\n(정확도: 약 ${Math.round(accuracy)}m)`);
                
                // 인근 공방 필터링하여 다시 로드
                await loadNearbyClasses(latitude, longitude);

            } catch (error) {
                console.error('❌ [Healing Map] 위치 가져오기 실패:', error);
                
                // 에러 메시지 처리
                let errorMessage = '위치를 가져올 수 없습니다.';
                
                if (error.code) {
                    // Geolocation API 에러
                    switch (error.code) {
                        case error.PERMISSION_DENIED:
                            errorMessage = '위치 권한이 거부되었습니다.\n\n브라우저 설정에서 위치 권한을 허용해주세요.';
                            break;
                        case error.POSITION_UNAVAILABLE:
                            errorMessage = '위치 정보를 사용할 수 없습니다.';
                            break;
                        case error.TIMEOUT:
                            errorMessage = '위치 요청 시간이 초과되었습니다.\n\n다시 시도해주세요.';
                            break;
                    }
                } else {
                    // 서버 API 에러
                    errorMessage = error.message || errorMessage;
                    
                    // 로그인 관련 에러인 경우 힌트 추가
                    if (errorMessage.includes('로그인') || errorMessage.includes('인증') || errorMessage.includes('토큰')) {
                        errorMessage += '\n\n다시 로그인 후 시도해주세요.';
                    }
                }
                
                alert('❌ 위치 업데이트 실패\n\n' + errorMessage);
            } finally {
                // 버튼 원상복구
                button.disabled = false;
                button.innerHTML = originalHTML;
            }
        }

        // 인근 공방 로드 (위치 기반 필터링)
        async function loadNearbyClasses(latitude, longitude) {
            try {
                console.log(`🔍 [Nearby Classes] 인근 공방 검색: lat=${latitude}, lng=${longitude}`);
                
                // nearby=true 파라미터로 인근 클래스만 조회 (기본 50km)
                const response = await fetch(`/api/oneday-classes?nearby=true&maxDistance=50&provider=${currentUser.provider}`);
                
                if (!response.ok) {
                    throw new Error(`API 요청 실패: ${response.status}`);
                }
                
                const nearbyClasses = await response.json();
                console.log(`✅ [Nearby Classes] ${nearbyClasses.length}개 인근 공방 발견`);
                
                if (nearbyClasses.length === 0) {
                    alert('😢 50km 이내에 공방이 없습니다.\n\n검색 반경을 늘리거나 다른 지역을 검색해보세요.');
                    return;
                }
                
                // 전역 classes 변수 업데이트
                classes = nearbyClasses;
                
                // 지도와 리스트 다시 렌더링
                await initializeMapByProvider();
                
                // 거리별 카운트
                const nearby = nearbyClasses.filter(c => c.distance <= 20).length;
                const medium = nearbyClasses.filter(c => c.distance > 20 && c.distance <= 50).length;
                
                let message = `✅ ${nearbyClasses.length}개의 인근 공방을 찾았습니다!\n\n`;
                if (nearby > 0) message += `🚶 가까운 지역 (20km 이내): ${nearby}개\n`;
                if (medium > 0) message += `🚗 인근 지역 (20-50km): ${medium}개\n`;
                message += '\n지도에서 위치를 확인해보세요!';
                
                alert(message);
                
            } catch (error) {
                console.error('❌ [Nearby Classes] 인근 공방 로드 실패:', error);
                alert('인근 공방을 불러오는데 실패했습니다.\n\n' + error.message);
            }
        }

        // ========================================
        // 위치 선택 모달 관련 함수
        // ========================================
        
        function showLocationModal() {
            console.log('[Location Modal] Opening modal');
            
            // 제공자별 UI 업데이트
            updateLocationModalUI();
            
            // 저장된 주소가 있으면 표시
            if (currentUser && currentUser.address && currentUser.user_latitude && currentUser.user_longitude) {
                document.getElementById('savedAddressInfo').classList.remove('hidden');
                document.getElementById('savedAddressText').textContent = currentUser.address;
            } else {
                document.getElementById('savedAddressInfo').classList.add('hidden');
            }
            
            document.getElementById('locationModal').classList.remove('hidden');
        }
        
        function closeLocationModal() {
            console.log('[Location Modal] Closing modal');
            document.getElementById('locationModal').classList.add('hidden');
        }
        
        function updateLocationModalUI() {
            if (!currentUser) return;
            
            const provider = currentUser.provider;
            const iconEl = document.getElementById('addressProviderIcon');
            const nameEl = document.getElementById('addressProviderName');
            const descEl = document.getElementById('addressProviderDesc');
            
            if (provider === 'naver') {
                iconEl.className = 'w-12 h-12 bg-green-100 rounded-full flex items-center justify-center group-hover:bg-green-200 transition';
                iconEl.innerHTML = '<i class="fas fa-map-marked-alt text-green-600 text-xl"></i>';
                nameEl.textContent = 'Naver 지도로 주소 검색';
                descEl.textContent = '네이버 지도를 사용하여 정확한 주소를 검색합니다';
            } else if (provider === 'kakao') {
                iconEl.className = 'w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center group-hover:bg-yellow-200 transition';
                iconEl.innerHTML = '<i class="fas fa-search-location text-yellow-600 text-xl"></i>';
                nameEl.textContent = 'Kakao 우편번호로 주소 검색';
                descEl.textContent = '카카오 우편번호 서비스를 사용하여 주소를 검색합니다';
            } else if (provider === 'google') {
                iconEl.className = 'w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center group-hover:bg-blue-200 transition';
                iconEl.innerHTML = '<i class="fas fa-map-pin text-blue-600 text-xl"></i>';
                nameEl.textContent = 'Google Places로 주소 검색';
                descEl.textContent = '구글 플레이스를 사용하여 정확한 주소를 검색합니다';
            }
        }
        
        function useGPS() {
            console.log('[GPS] Using GPS location');
            closeLocationModal();
            useCurrentLocationForMap();
        }
        
        function searchAddressByProvider() {
            if (!currentUser) {
                alert('로그인이 필요합니다.');
                return;
            }
            
            const provider = currentUser.provider;
            console.log(`[Address Search] Using ${provider} address search`);
            
            if (provider === 'naver') {
                searchAddressNaver();
            } else if (provider === 'kakao') {
                searchAddressKakao();
            } else if (provider === 'google') {
                searchAddressGoogle();
            }
        }
        
        function useSavedAddress() {
            if (!currentUser || !currentUser.user_latitude || !currentUser.user_longitude) {
                alert('저장된 주소 정보가 없습니다.');
                return;
            }
            
            console.log('[Saved Address] Using saved address:', currentUser.address);
            closeLocationModal();
            
            // 저장된 좌표로 검색
            loadNearbyClasses();
        }
        
        // ========================================
        // Naver 주소 검색
        // ========================================
        
        function searchAddressNaver() {
            const address = prompt('주소를 입력하세요 (예: 인천 계양구 작전동 863-17)');
            
            if (!address) return;
            
            console.log('[Naver Address] Searching:', address);
            closeLocationModal();
            
            // Naver Geocoding API 호출
            geocodeAddressNaver(address);
        }
        
        async function geocodeAddressNaver(address) {
            try {
                console.log('[Naver Geocoding] Converting address to coordinates:', address);
                
                // 백엔드 API를 통해 Naver Geocoding 호출
                const response = await fetch(`/api/geocode/naver?address=${encodeURIComponent(address)}`);
                
                if (!response.ok) {
                    throw new Error('Naver Geocoding API 호출 실패');
                }
                
                const data = await response.json();
                
                if (data.latitude && data.longitude) {
                    console.log('[Naver Geocoding] Success:', data);
                    
                    // 사용자 위치 업데이트
                    await updateUserLocation(data.latitude, data.longitude, address);
                    
                    // 지도 새로고침
                    loadNearbyClasses();
                } else {
                    throw new Error('주소를 찾을 수 없습니다.');
                }
            } catch (error) {
                console.error('[Naver Geocoding] Error:', error);
                alert('주소 변환에 실패했습니다.\n\n' + error.message);
            }
        }
        
        // ========================================
        // Kakao 주소 검색
        // ========================================
        
        function searchAddressKakao() {
            console.log('[Kakao Address] Opening Kakao Postcode');
            closeLocationModal();
            
            // Kakao 우편번호 서비스 열기
            document.getElementById('kakaoAddressModal').classList.remove('hidden');
            
            new daum.Postcode({
                oncomplete: function(data) {
                    console.log('[Kakao Address] Selected:', data);
                    
                    const fullAddress = data.roadAddress || data.jibunAddress;
                    
                    // Kakao Geocoding으로 좌표 변환
                    geocodeAddressKakao(fullAddress);
                    
                    closeKakaoAddressModal();
                },
                width: '100%',
                height: '100%'
            }).embed(document.getElementById('kakaoAddressLayer'));
        }
        
        function closeKakaoAddressModal() {
            document.getElementById('kakaoAddressModal').classList.add('hidden');
            document.getElementById('kakaoAddressLayer').innerHTML = '';
        }
        
        async function geocodeAddressKakao(address) {
            try {
                console.log('[Kakao Geocoding] Converting address to coordinates:', address);
                
                // 백엔드 API를 통해 Kakao Geocoding 호출
                const response = await fetch(`/api/geocode/kakao?address=${encodeURIComponent(address)}`);
                
                if (!response.ok) {
                    throw new Error('Kakao Geocoding API 호출 실패');
                }
                
                const data = await response.json();
                
                if (data.latitude && data.longitude) {
                    console.log('[Kakao Geocoding] Success:', data);
                    
                    // 사용자 위치 업데이트
                    await updateUserLocation(data.latitude, data.longitude, address);
                    
                    // 지도 새로고침
                    loadNearbyClasses();
                } else {
                    throw new Error('주소를 찾을 수 없습니다.');
                }
            } catch (error) {
                console.error('[Kakao Geocoding] Error:', error);
                alert('주소 변환에 실패했습니다.\n\n' + error.message);
            }
        }
        
        // ========================================
        // Google 주소 검색
        // ========================================
        
        function searchAddressGoogle() {
            const address = prompt('주소를 입력하세요 (예: 인천 계양구 작전동 863-17)');
            
            if (!address) return;
            
            console.log('[Google Address] Searching:', address);
            closeLocationModal();
            
            // Google Geocoding API 호출
            geocodeAddressGoogle(address);
        }
        
        async function geocodeAddressGoogle(address) {
            try {
                console.log('[Google Geocoding] Converting address to coordinates:', address);
                
                // 백엔드 API를 통해 Google Geocoding 호출
                const response = await fetch(`/api/geocode/google?address=${encodeURIComponent(address)}`);
                
                if (!response.ok) {
                    throw new Error('Google Geocoding API 호출 실패');
                }
                
                const data = await response.json();
                
                if (data.latitude && data.longitude) {
                    console.log('[Google Geocoding] Success:', data);
                    
                    // 사용자 위치 업데이트
                    await updateUserLocation(data.latitude, data.longitude, address);
                    
                    // 지도 새로고침
                    loadNearbyClasses();
                } else {
                    throw new Error('주소를 찾을 수 없습니다.');
                }
            } catch (error) {
                console.error('[Google Geocoding] Error:', error);
                alert('주소 변환에 실패했습니다.\n\n' + error.message);
            }
        }
        
        // ========================================
        // 사용자 위치 업데이트 (공통)
        // ========================================
        
        async function updateUserLocation(latitude, longitude, address) {
            try {
                console.log('[Update Location] Saving location:', { latitude, longitude, address });
                
                const response = await fetch('/api/user/location', {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    credentials: 'include',  // 쿠키 포함
                    body: JSON.stringify({
                        latitude,
                        longitude,
                        address
                    })
                });
                
                const data = await response.json();
                console.log('[Update Location] Response:', data);
                
                if (!response.ok) {
                    // 상세한 에러 메시지 표시
                    const errorMsg = data.error || '위치 업데이트 실패';
                    throw new Error(`${errorMsg} (HTTP ${response.status})`);
                }
                
                console.log('[Update Location] Success:', data);
                
                // currentUser 정보 업데이트
                if (currentUser) {
                    currentUser.user_latitude = latitude;
                    currentUser.user_longitude = longitude;
                    currentUser.address = address;
                }
                
                alert(`✅ 위치가 성공적으로 설정되었습니다!\n\n📍 ${address}\n📏 위도: ${latitude.toFixed(6)}, 경도: ${longitude.toFixed(6)}`);
                
            } catch (error) {
                console.error('[Update Location] Error:', error);
                alert(`❌ 위치 저장에 실패했습니다.\n\n${error.message}\n\n💡 로그인 상태를 확인해주세요.`);
            }
        }

        // Page load
        document.addEventListener('DOMContentLoaded', function() {
            loadProperties();
        });
        

    </script>
    
    <style>
        @keyframes scale-in {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        .animate-scale-in {
            animation: scale-in 0.3s ease-out;
        }
        
        /* Line clamp utility for description text */
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
    </style>

    <!-- Booking Modal -->
    <div id="booking-modal" class="hidden fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4 overflow-y-auto">
        <div class="bg-white rounded-3xl max-w-2xl w-full my-8 shadow-2xl">
            <div class="bg-gradient-to-r from-purple-600 to-pink-600 text-white p-6 rounded-t-3xl">
                <div class="flex items-center justify-between">
                    <h3 class="text-2xl font-bold">
                        <i class="fas fa-calendar-check mr-2"></i>
                        클래스 예약
                    </h3>
                    <button onclick="closeBookingModal()" class="text-white hover:bg-white/20 rounded-full w-10 h-10 flex items-center justify-center transition">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                <p class="text-purple-100 mt-2" id="booking-class-title">클래스명</p>
                <p class="text-purple-200 text-sm" id="booking-class-info">위치 · 가격</p>
            </div>
            
            <form id="booking-form" onsubmit="submitBooking(event)" class="p-8">
                <input type="hidden" id="booking-class-id">
                
                <div class="space-y-6">
                    <!-- Date & Time -->
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">
                                <i class="fas fa-calendar mr-2 text-purple-600"></i>예약 날짜
                            </label>
                            <input type="date" id="booking-date" required 
                                   class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-purple-600 focus:outline-none"
                                   min="<?php echo date('Y-m-d'); ?>">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">
                                <i class="fas fa-clock mr-2 text-purple-600"></i>예약 시간
                            </label>
                            <input type="time" id="booking-time" required 
                                   class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-purple-600 focus:outline-none">
                        </div>
                    </div>
                    
                    <!-- Participants -->
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-users mr-2 text-purple-600"></i>참가 인원
                        </label>
                        <select id="participants" required 
                                class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-purple-600 focus:outline-none">
                            <option value="1">1명</option>
                            <option value="2">2명</option>
                            <option value="3">3명</option>
                            <option value="4">4명</option>
                            <option value="5">5명 이상</option>
                        </select>
                    </div>
                    
                    <!-- Booker Info -->
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-user mr-2 text-purple-600"></i>예약자 이름
                        </label>
                        <input type="text" id="booker-name" required 
                               class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-purple-600 focus:outline-none"
                               placeholder="이름을 입력하세요">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-phone mr-2 text-purple-600"></i>연락처
                        </label>
                        <input type="tel" id="booker-phone" required 
                               class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-purple-600 focus:outline-none"
                               placeholder="010-0000-0000">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-envelope mr-2 text-purple-600"></i>이메일
                        </label>
                        <input type="email" id="booker-email" required 
                               class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-purple-600 focus:outline-none"
                               placeholder="email@example.com">
                    </div>
                    
                    <!-- Submit Button -->
                    <button type="submit" 
                            class="w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white px-8 py-4 rounded-lg text-lg font-bold hover:shadow-xl transition transform hover:scale-105">
                        <i class="fas fa-check-circle mr-2"></i>예약 완료
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Booking Success Modal -->
    <div id="success-modal" class="hidden fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4">
        <div class="bg-white rounded-3xl max-w-md w-full shadow-2xl animate-scale-in">
            <div class="bg-gradient-to-r from-green-500 to-teal-500 text-white p-8 rounded-t-3xl text-center">
                <div class="w-20 h-20 bg-white rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-check text-green-500 text-4xl"></i>
                </div>
                <h3 class="text-2xl font-bold mb-2">예약이 완료되었습니다!</h3>
                <p class="text-green-100">예약 번호: <span id="success-booking-id" class="font-bold"></span></p>
            </div>
            
            <div class="p-8 space-y-4">
                <p class="text-gray-600 text-center">
                    예약 확인 메일이 발송되었습니다.<br>
                    아래 버튼으로 캘린더에 일정을 추가하세요.
                </p>
                
                <a id="icalendar-link" href="#" download
                   class="block w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white px-6 py-4 rounded-lg text-center font-bold hover:shadow-xl transition transform hover:scale-105">
                    <i class="fas fa-calendar-plus mr-2"></i>Google Calendar에 추가
                </a>
                
                <button onclick="closeSuccessModal()" 
                        class="w-full bg-gray-200 text-gray-700 px-6 py-3 rounded-lg font-semibold hover:bg-gray-300 transition">
                    닫기
                </button>
            </div>
        </div>
    </div>

    <!-- 위치 선택 모달 -->
    <div id="locationModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl max-w-md w-full p-8 relative">
            <button onclick="closeLocationModal()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                <i class="fas fa-times text-2xl"></i>
            </button>
            
            <h3 class="text-2xl font-bold text-gray-900 mb-6 text-center">
                <i class="fas fa-map-marker-alt text-purple-600 mr-2"></i>
                내 위치 설정
            </h3>
            
            <p class="text-gray-600 text-center mb-8">
                위치를 설정하는 방법을 선택하세요
            </p>
            
            <!-- GPS 자동 감지 옵션 -->
            <button onclick="useGPS()" class="w-full mb-4 p-6 border-2 border-gray-200 rounded-xl hover:border-purple-500 hover:bg-purple-50 transition group">
                <div class="flex items-start gap-4">
                    <div class="flex-shrink-0">
                        <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center group-hover:bg-green-200 transition">
                            <i class="fas fa-location-crosshairs text-green-600 text-xl"></i>
                        </div>
                    </div>
                    <div class="flex-1 text-left">
                        <h4 class="font-bold text-gray-900 mb-1 flex items-center">
                            현재 위치 자동 감지
                            <span class="ml-2 text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full">빠름</span>
                        </h4>
                        <p class="text-sm text-gray-600">
                            GPS를 사용하여 현재 위치를 자동으로 감지합니다
                        </p>
                    </div>
                </div>
            </button>
            
            <div class="text-center text-gray-400 font-semibold my-4">또는</div>
            
            <!-- 주소 검색 옵션 (제공자별 다른 아이콘) -->
            <button onclick="searchAddressByProvider()" class="w-full p-6 border-2 border-gray-200 rounded-xl hover:border-purple-500 hover:bg-purple-50 transition group">
                <div class="flex items-start gap-4">
                    <div class="flex-shrink-0">
                        <div id="addressProviderIcon" class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center group-hover:bg-blue-200 transition">
                            <i class="fas fa-home text-blue-600 text-xl"></i>
                        </div>
                    </div>
                    <div class="flex-1 text-left">
                        <h4 class="font-bold text-gray-900 mb-1 flex items-center">
                            <span id="addressProviderName">주소로 직접 입력</span>
                            <span class="ml-2 text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full">정확</span>
                        </h4>
                        <p class="text-sm text-gray-600" id="addressProviderDesc">
                            집이나 회사 주소를 입력하여 위치를 설정합니다
                        </p>
                    </div>
                </div>
            </button>
            
            <!-- 저장된 주소 표시 (있는 경우) -->
            <div id="savedAddressInfo" class="hidden mt-6 p-4 bg-gray-50 rounded-lg">
                <p class="text-xs text-gray-500 mb-1">저장된 주소</p>
                <p id="savedAddressText" class="text-sm text-gray-900 font-medium"></p>
                <button onclick="useSavedAddress()" class="mt-2 text-xs text-purple-600 hover:text-purple-700 font-semibold">
                    <i class="fas fa-check-circle mr-1"></i>
                    이 주소로 검색하기
                </button>
            </div>
        </div>
    </div>
    
    <!-- Kakao 주소 검색 모달 -->
    <div id="kakaoAddressModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full relative">
            <div class="p-4 border-b flex items-center justify-between">
                <h3 class="text-lg font-bold text-gray-900">
                    <i class="fas fa-search text-yellow-500 mr-2"></i>
                    Kakao 주소 검색
                </h3>
                <button onclick="closeKakaoAddressModal()" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div id="kakaoAddressLayer" style="height: 500px;"></div>
        </div>
    </div>

</body>
</html>
