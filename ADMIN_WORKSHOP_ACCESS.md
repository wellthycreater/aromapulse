# ğŸ”‘ ì›Œí¬ìƒµ í˜ì´ì§€ ê´€ë¦¬ì ì„ì‹œ ì ‘ì† í—ˆìš©

## ğŸ“‹ ìš”êµ¬ì‚¬í•­

**ë¬¸ì œ**: ì›Œí¬ìƒµì€ ì›ë˜ B2B ì´ìš©ìë§Œ ë³¼ ìˆ˜ ìˆëŠ”ë°, ìš´ì˜ìëŠ” ì„ì‹œë¡œ ì ‘ì†ì´ ê°€ëŠ¥í•´ì•¼ í•¨

**í•´ê²°**: ê´€ë¦¬ì(admin) ê³„ì •ì€ ëª¨ë“  B2B ì œí•œì„ ìš°íšŒí•˜ì—¬ ì ‘ì† ê°€ëŠ¥

---

## âœ… êµ¬í˜„ ë‚´ìš©

### 1. ê¶Œí•œ ì²´í¬ ë¡œì§ ìˆ˜ì •

**ìˆ˜ì • ì „ (B2Bë§Œ í—ˆìš©)**:
```javascript
function checkQuotePermission() {
    const user = JSON.parse(localStorage.getItem('user'));
    
    // B2B ì‚¬ìš©ì ì²´í¬
    if (user.user_type !== 'B2B') {
        return { hasPermission: false, reason: 'not_b2b' };
    }
    
    // íšŒì‚¬ ê·œëª¨ ì²´í¬ (20ì¸ ì´ìƒ)
    // ë‹´ë‹¹ì ì—­í•  ì²´í¬ (HR, ì¡°ì§ë¬¸í™”, ë³µë¦¬í›„ìƒ)
    // ...
    
    return { hasPermission: true };
}
```

**ìˆ˜ì • í›„ (ê´€ë¦¬ì ìš°íšŒ ì¶”ê°€)**:
```javascript
function checkQuotePermission() {
    const user = JSON.parse(localStorage.getItem('user'));
    
    // ğŸ”‘ ê´€ë¦¬ìëŠ” ëª¨ë“  ê¶Œí•œ ìš°íšŒ (ì„ì‹œ ì ‘ì† í—ˆìš©)
    if (user.is_admin === 1 || user.role === 'admin') {
        return { hasPermission: true, isAdmin: true };
    }
    
    // B2B ì‚¬ìš©ì ì²´í¬
    if (user.user_type !== 'B2B') {
        return { hasPermission: false, reason: 'not_b2b' };
    }
    
    // íšŒì‚¬ ê·œëª¨ ì²´í¬ (20ì¸ ì´ìƒ)
    // ë‹´ë‹¹ì ì—­í•  ì²´í¬ (HR, ì¡°ì§ë¬¸í™”, ë³µë¦¬í›„ìƒ)
    // ...
    
    return { hasPermission: true };
}
```

### 2. ê´€ë¦¬ì ê°ì§€ ì¡°ê±´

**ë‘ ê°€ì§€ ë°©ì‹ìœ¼ë¡œ ê´€ë¦¬ì ê°ì§€**:
1. `user.is_admin === 1` - ë°ì´í„°ë² ì´ìŠ¤ì˜ is_admin ì»¬ëŸ¼
2. `user.role === 'admin'` - role ì»¬ëŸ¼ì´ 'admin'ì¸ ê²½ìš°

**ë‘˜ ì¤‘ í•˜ë‚˜ë§Œ ì¶©ì¡±í•´ë„ ê´€ë¦¬ìë¡œ ì¸ì •**ë©ë‹ˆë‹¤.

### 3. ìˆ˜ì •ëœ íŒŒì¼

#### `/home/user/webapp/public/static/workshops.js`
**Line 36-69**: `checkQuotePermission()` í•¨ìˆ˜
- ê´€ë¦¬ì ì²´í¬ ë¡œì§ ì¶”ê°€ (Line 50-53)
- ê´€ë¦¬ìëŠ” B2B, íšŒì‚¬ ê·œëª¨, ë‹´ë‹¹ì ì—­í•  ì²´í¬ ëª¨ë‘ ìš°íšŒ

#### `/home/user/webapp/public/static/workshop-detail.js`
**Line 159-193**: `checkQuotePermission()` í•¨ìˆ˜
- ë™ì¼í•œ ê´€ë¦¬ì ì²´í¬ ë¡œì§ ì¶”ê°€
- ê²¬ì  ë¬¸ì˜ í¼ ì œì¶œ ì‹œ ê¶Œí•œ ì²´í¬ì—ì„œë„ ì ìš©

---

## ğŸ¯ ì‘ë™ ë°©ì‹

### ì¼ë°˜ ì‚¬ìš©ì (B2C)
```
ì›Œí¬ìƒµ í˜ì´ì§€ ì ‘ì† â†’ checkQuotePermission() í˜¸ì¶œ
â†’ is_admin ì²´í¬ (âŒ ì¼ë°˜ ì‚¬ìš©ì)
â†’ B2B ì²´í¬ (âŒ B2C ì‚¬ìš©ì)
â†’ ì—ëŸ¬: "ì›Œí¬ìƒµ ê²¬ì  ë¬¸ì˜ëŠ” B2B ê¸°ì—… ê³ ê°ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤."
```

### B2B ì‚¬ìš©ì (ì¡°ê±´ ë¯¸ë‹¬)
```
ì›Œí¬ìƒµ í˜ì´ì§€ ì ‘ì† â†’ checkQuotePermission() í˜¸ì¶œ
â†’ is_admin ì²´í¬ (âŒ ì¼ë°˜ ì‚¬ìš©ì)
â†’ B2B ì²´í¬ (âœ… B2B ì‚¬ìš©ì)
â†’ íšŒì‚¬ ê·œëª¨ ì²´í¬ (âŒ 20ì¸ ë¯¸ë§Œ)
â†’ ì—ëŸ¬: "ì›Œí¬ìƒµì€ 20ì¸ ì´ìƒ ê·œëª¨ì˜ ê¸°ì—…ë§Œ ì´ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤."
```

### ê´€ë¦¬ì (Admin)
```
ì›Œí¬ìƒµ í˜ì´ì§€ ì ‘ì† â†’ checkQuotePermission() í˜¸ì¶œ
â†’ is_admin ì²´í¬ (âœ… ê´€ë¦¬ì)
â†’ ì¦‰ì‹œ í—ˆìš©! hasPermission: true, isAdmin: true ë°˜í™˜
â†’ ëª¨ë“  ì›Œí¬ìƒµ ê¸°ëŠ¥ ì‚¬ìš© ê°€ëŠ¥ âœ…
```

---

## ğŸ” ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

### 1. ê´€ë¦¬ì ê³„ì • í™•ì¸ ë°©ë²•

**ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ í™•ì¸**:
```sql
SELECT id, email, name, is_admin, role 
FROM users 
WHERE is_admin = 1 OR role = 'admin';
```

### 2. ê´€ë¦¬ì ê³„ì • ìƒì„± ë°©ë²•

**ê¸°ì¡´ ì‚¬ìš©ìë¥¼ ê´€ë¦¬ìë¡œ ìŠ¹ê²©**:
```sql
UPDATE users 
SET is_admin = 1, role = 'admin' 
WHERE email = 'admin@aromapulse.kr';
```

**ë˜ëŠ” roleë§Œ ì„¤ì •**:
```sql
UPDATE users 
SET role = 'admin' 
WHERE email = 'admin@aromapulse.kr';
```

### 3. ì„ì‹œ ì ‘ì†ì˜ ì˜ë¯¸

**"ì„ì‹œ ì ‘ì†"ì´ë€**:
- ìš´ì˜ìê°€ ì›Œí¬ìƒµ í˜ì´ì§€ë¥¼ ìˆ˜ì •í•˜ê³  í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆë„ë¡ í—ˆìš©
- B2B ìš”êµ¬ì‚¬í•­ì„ ìš°íšŒí•˜ì—¬ ì ‘ì† ê°€ëŠ¥
- ì‹¤ì œ B2B ê³ ê°ê³¼ ë™ì¼í•œ ê¸°ëŠ¥ ì‚¬ìš© ê°€ëŠ¥
- ì¶”í›„ ì •ì‹ B2B ê¸°ëŠ¥ ì™„ì„± ì‹œì—ë„ ìœ ì§€ ê°€ëŠ¥

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ë°©ë²•

### 1. ê´€ë¦¬ì ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸

```
https://www.aromapulse.kr/login

ì´ë©”ì¼: admin@aromapulse.kr (ë˜ëŠ” ê´€ë¦¬ì ì´ë©”ì¼)
ë¹„ë°€ë²ˆí˜¸: (ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸)
```

### 2. ë¡œê·¸ì¸ í›„ localStorage í™•ì¸

**ë¸Œë¼ìš°ì € ì½˜ì†”(F12)ì—ì„œ**:
```javascript
// ì‚¬ìš©ì ì •ë³´ í™•ì¸
const user = JSON.parse(localStorage.getItem('user'));
console.log('ì‚¬ìš©ì ì •ë³´:', user);
console.log('is_admin:', user.is_admin);
console.log('role:', user.role);
```

**ì˜ˆìƒ ì¶œë ¥**:
```json
{
  "id": 1,
  "email": "admin@aromapulse.kr",
  "name": "ê´€ë¦¬ì",
  "is_admin": 1,
  "role": "admin",
  "user_type": "B2C"  // B2Cì—¬ë„ ê´€ê³„ì—†ìŒ!
}
```

### 3. ì›Œí¬ìƒµ í˜ì´ì§€ ì ‘ì† í…ŒìŠ¤íŠ¸

```
https://www.aromapulse.kr/workshops
â†’ âœ… ì›Œí¬ìƒµ ëª©ë¡ í‘œì‹œë¨

https://www.aromapulse.kr/workshop/201
â†’ âœ… ì›Œí¬ìƒµ ìƒì„¸ í˜ì´ì§€ ì ‘ì† ê°€ëŠ¥
â†’ âœ… ê²¬ì  ë¬¸ì˜ í¼ ì‘ì„± ë° ì œì¶œ ê°€ëŠ¥
```

### 4. ê¶Œí•œ ì²´í¬ ë¡œì§ í™•ì¸

**ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ**:
```javascript
// checkQuotePermission í•¨ìˆ˜ ì§ì ‘ í˜¸ì¶œ
const permission = checkQuotePermission();
console.log('ê¶Œí•œ ì²´í¬ ê²°ê³¼:', permission);
```

**ê´€ë¦¬ì ì˜ˆìƒ ì¶œë ¥**:
```json
{
  "hasPermission": true,
  "isAdmin": true
}
```

**ì¼ë°˜ B2C ì‚¬ìš©ì ì˜ˆìƒ ì¶œë ¥**:
```json
{
  "hasPermission": false,
  "reason": "not_b2b"
}
```

---

## ğŸ“Š ê¶Œí•œ ë§¤íŠ¸ë¦­ìŠ¤

| ì‚¬ìš©ì ìœ í˜• | is_admin | user_type | company_size | company_role | ì›Œí¬ìƒµ ì ‘ì† | ê²¬ì  ë¬¸ì˜ |
|------------|----------|-----------|--------------|--------------|------------|-----------|
| **ê´€ë¦¬ì** | 1 | B2C/B2B | - | - | âœ… | âœ… |
| B2B (ì¡°ê±´ ì¶©ì¡±) | 0 | B2B | 20+ | HR/ë³µë¦¬í›„ìƒ | âœ… | âœ… |
| B2B (ê·œëª¨ ë¯¸ë‹¬) | 0 | B2B | <20 | - | âœ… (ëª©ë¡) | âŒ |
| B2B (ì—­í•  ë¯¸ë‹¬) | 0 | B2B | 20+ | ì¼ë°˜ì§ì› | âœ… (ëª©ë¡) | âŒ |
| B2C | 0 | B2C | - | - | âœ… (ëª©ë¡) | âŒ |

**ì£¼ì˜**: ì›Œí¬ìƒµ ëª©ë¡ì€ ëª¨ë“  ì‚¬ìš©ìì—ê²Œ ê³µê°œë˜ì§€ë§Œ, **ê²¬ì  ë¬¸ì˜ëŠ” ì¡°ê±´ì„ ì¶©ì¡±í•œ ì‚¬ìš©ìë§Œ** ê°€ëŠ¥í•©ë‹ˆë‹¤.

---

## ğŸš€ ë°°í¬ ì™„ë£Œ

**ë°°í¬ URL**: https://www.aromapulse.kr
**ë°°í¬ ì‹œê°„**: 2025-11-22
**Git ì»¤ë°‹**: 1f5064b

**í™•ì¸ í˜ì´ì§€**:
- ì›Œí¬ìƒµ ëª©ë¡: https://www.aromapulse.kr/workshops
- ì›Œí¬ìƒµ ìƒì„¸: https://www.aromapulse.kr/workshop/201

---

## ğŸ“ í–¥í›„ ê°œì„ ì‚¬í•­

### 1. ê´€ë¦¬ì ì „ìš© ê¸°ëŠ¥ ì¶”ê°€

ê´€ë¦¬ì ë¡œê·¸ì¸ ì‹œ ì¶”ê°€ ê¸°ëŠ¥ ì œê³µ:
- ì›Œí¬ìƒµ ìˆ˜ì •/ì‚­ì œ ë²„íŠ¼
- ê²¬ì  ë¬¸ì˜ ë‚´ì—­ í™•ì¸
- í†µê³„ ë° ë¶„ì„ ë°ì´í„°

### 2. ì„ì‹œ ì ‘ì† ë¡œê·¸ ê¸°ë¡

ê´€ë¦¬ìì˜ ì›Œí¬ìƒµ ì ‘ì† ë° ê²¬ì  ë¬¸ì˜ë¥¼ ë³„ë„ë¡œ ë¡œê·¸:
```sql
INSERT INTO admin_access_logs (user_id, action, resource_type, resource_id)
VALUES (1, 'view_workshop', 'workshop', 201);
```

### 3. ê´€ë¦¬ì ë°°ì§€ í‘œì‹œ

ì›Œí¬ìƒµ í˜ì´ì§€ì—ì„œ ê´€ë¦¬ì ë¡œê·¸ì¸ ì‹œ ë°°ì§€ í‘œì‹œ:
```html
<div class="admin-badge">
  ğŸ”‘ ê´€ë¦¬ì ëª¨ë“œ
</div>
```

---

## ğŸ‰ ê²°ê³¼

**ì´ì œ ìš´ì˜ì(admin)ëŠ”**:
- âœ… ì›Œí¬ìƒµ í˜ì´ì§€ì— ììœ ë¡­ê²Œ ì ‘ì† ê°€ëŠ¥
- âœ… ëª¨ë“  ì›Œí¬ìƒµ ìƒì„¸ ì •ë³´ í™•ì¸ ê°€ëŠ¥
- âœ… ê²¬ì  ë¬¸ì˜ í¼ ì‘ì„± ë° ì œì¶œ ê°€ëŠ¥
- âœ… B2B ì œí•œ ì—†ì´ ì›Œí¬ìƒµ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥

**ì¼ë°˜ ì‚¬ìš©ìëŠ”**:
- âœ… ê¸°ì¡´ê³¼ ë™ì¼í•˜ê²Œ B2B ì¡°ê±´ ì²´í¬
- âœ… ì¡°ê±´ ë¯¸ë‹¬ ì‹œ ì ì ˆí•œ ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ
- âœ… ë³´ì•ˆ ë° ê¶Œí•œ ì‹œìŠ¤í…œ ì •ìƒ ì‘ë™
