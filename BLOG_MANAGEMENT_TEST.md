# 블로그 관리 시스템 테스트 가이드

## 📋 테스트 환경

**개발 환경 URL**: https://3000-ixw6l6ek5pa4nw2e7gi09-c07dda5e.sandbox.novita.ai

## 🎯 테스트 절차

### 1단계: 관리자 로그인

**방법 1: 기존 관리자 계정 사용**
1. `/login` 페이지로 이동
2. 관리자 계정으로 로그인
   - 이메일: `admin@aromapulse.kr` (또는 생성한 관리자 계정)
   - 비밀번호: (설정한 비밀번호)

**방법 2: 새 관리자 계정 생성**
1. `/create-admin` 페이지로 이동
2. 정보 입력:
   - 이메일: 원하는 이메일
   - 비밀번호: 안전한 비밀번호
   - 이름: 관리자 이름
   - 연락처: 전화번호
   - **관리자 비밀 키**: `aromapulse-admin-2025`
3. 계정 생성 후 로그인

### 2단계: 관리자 페이지 접속

1. 로그인 후 `/admin-products` 페이지로 이동
2. 상단의 탭 메뉴 확인:
   - 전체 (0)
   - 증상케어 (0)
   - 리프레시 (0)
   - **블로그 관리 (0)** ← 새로 추가된 탭

### 3단계: 블로그 관리 탭 테스트

1. **"블로그 관리" 탭 클릭**
   - 제품 그리드가 숨겨지고 블로그 관리 섹션이 표시됨
   - 두 개의 카드가 보여야 함:
     - 블로그 게시물 등록 카드
     - 등록된 블로그 게시물 목록 카드

2. **블로그 URL 입력**
   - URL 입력란에 네이버 블로그 게시물 URL 입력
   - 예시: `https://blog.naver.com/aromapulse/223921529276`
   - "댓글 수집 및 분석" 버튼 클릭

3. **댓글 수집 결과 확인**
   - Alert 메시지로 수집 결과 표시:
     ```
     댓글 수집 완료!
     
     - 총 댓글: 5개
     - 구매 의도: 3개
     - B2C: 3개
     - B2B: 2개
     - 생성된 챗봇 세션: 3개
     ```
   - "확인" 클릭

4. **등록된 게시물 목록 확인**
   - 하단의 "등록된 블로그 게시물" 섹션에 새 게시물 카드 표시
   - 게시물 정보 확인:
     - 게시물 ID
     - 댓글 수
     - 구매 의도 댓글 수
     - B2C/B2B 고객 분포
     - 생성된 챗봇 세션 수
   - "게시물 보기" 버튼: 네이버 블로그 새 탭 열림
   - "댓글 보기" 버튼: 수집된 댓글 목록 Alert 표시

### 4단계: 생성된 챗봇 세션 확인

1. **데이터베이스에서 확인** (선택사항)
   ```bash
   cd /home/user/webapp
   npx wrangler d1 execute webapp-production --local --command="SELECT * FROM chatbot_sessions ORDER BY id DESC LIMIT 5"
   ```

2. **챗봇 메시지 확인**
   ```bash
   npx wrangler d1 execute webapp-production --local --command="SELECT * FROM chatbot_messages WHERE session_id IN (SELECT id FROM chatbot_sessions ORDER BY id DESC LIMIT 3) ORDER BY created_at"
   ```

### 5단계: 다양한 시나리오 테스트

**시나리오 1: 여러 게시물 등록**
- 다양한 게시물 ID로 반복 테스트
  - 223921529276
  - 223921529277
  - 223921529278
- 블로그 관리 탭 카운터 증가 확인

**시나리오 2: 동일 게시물 중복 등록**
- 같은 URL을 두 번 입력
- 기존 게시물에 댓글만 추가되는지 확인

**시나리오 3: 잘못된 URL 입력**
- 네이버 블로그가 아닌 URL 입력
- 에러 메시지 표시 확인: "네이버 블로그 URL만 지원됩니다"

**시나리오 4: 탭 전환**
- 블로그 관리 ↔ 제품 탭 간 전환
- 각 탭의 컨텐츠가 올바르게 표시/숨김 되는지 확인

## ✅ 성공 기준

### UI/UX
- [ ] 블로그 관리 탭이 표시됨
- [ ] 탭 카운터가 올바르게 업데이트됨
- [ ] URL 입력 폼이 정상 작동함
- [ ] 게시물 목록이 카드 형식으로 표시됨

### 기능
- [ ] 블로그 URL에서 post_id 추출 성공
- [ ] 5개의 더미 댓글 생성 확인
- [ ] 감정/의도/키워드 분석 완료
- [ ] 구매 의도 댓글에서 챗봇 세션 자동 생성
- [ ] 챗봇 세션에 초기 메시지 3개 생성 (system, user, assistant)

### 데이터
- [ ] blog_posts 테이블에 게시물 등록
- [ ] blog_comments 테이블에 댓글 저장
- [ ] chatbot_sessions 테이블에 세션 생성
- [ ] chatbot_messages 테이블에 메시지 저장

## 🐛 예상 문제 및 해결

**문제 1: 관리자 페이지 접근 불가**
- 해결: 관리자 계정으로 로그인 확인
- 일반 사용자는 관리자 페이지 접근 불가

**문제 2: 블로그 탭이 보이지 않음**
- 해결: 브라우저 캐시 삭제 및 페이지 새로고침
- 빌드가 제대로 되었는지 확인

**문제 3: 댓글 수집 버튼 클릭 후 응답 없음**
- 해결: 브라우저 콘솔에서 에러 확인
- 네트워크 탭에서 API 요청/응답 확인

**문제 4: 챗봇 세션이 생성되지 않음**
- 해결: chatbot_sessions 테이블 구조 확인
- 컬럼명 일치 여부 확인 (detected_user_type vs user_type)

## 📊 테스트 데이터 예시

### 생성되는 더미 댓글

1. **B2B 구매 문의**
   - 작성자: 김민수
   - 내용: "라벤더 향수 구매하고 싶은데 가격이 얼마인가요? 회사에서 직원 복지용으로 대량 구매 가능한가요?"
   - 의도: B2B문의
   - 챗봇 세션: ✅ 생성

2. **B2C 구매 의도**
   - 작성자: 박지영
   - 내용: "불면증이 심해서 고민인데 라벤더 제품 효과가 있을까요? 구매 링크 있나요?"
   - 의도: 구매의도
   - 챗봇 세션: ✅ 생성

3. **긍정 리뷰**
   - 작성자: 이수진
   - 내용: "지난주에 구매했는데 정말 좋아요! 향도 은은하고 수면에 도움이 많이 되는 것 같아요."
   - 의도: 긍정리뷰
   - 챗봇 세션: ❌ 미생성

4. **B2B 가격 문의**
   - 작성자: 최대호
   - 내용: "사무실용으로 룸스프레이 필요한데 가격 문의 좀 드려요. 대량 구매 할인 있나요?"
   - 의도: 가격문의
   - 챗봇 세션: ✅ 생성

5. **긍정 리뷰**
   - 작성자: 정서연
   - 내용: "향기 정말 좋네요! 우울할 때 써보니 기분이 좀 나아지는 것 같아요"
   - 의도: 긍정리뷰
   - 챗봇 세션: ❌ 미생성

### 생성되는 챗봇 세션 메시지

**세션 1: 김민수 (B2B 문의)**
1. System: "블로그 댓글에서 시작된 대화입니다. 사용자: 김민수, 의도: B2B문의..."
2. User: "라벤더 향수 구매하고 싶은데..."
3. Assistant: "🏢 비즈니스 문의 감사합니다! 다음과 같은 서비스를 제공하고 있습니다..."

**세션 2: 박지영 (구매 의도)**
1. System: "블로그 댓글에서 시작된 대화입니다. 사용자: 박지영, 의도: 구매의도..."
2. User: "불면증이 심해서 고민인데..."
3. Assistant: "구매에 관심 가져주셔서 감사합니다! 🎁 첫 구매 고객님께 특별 혜택을..."

**세션 3: 최대호 (가격 문의)**
1. System: "블로그 댓글에서 시작된 대화입니다. 사용자: 최대호, 의도: 가격문의..."
2. User: "사무실용으로 룸스프레이 필요한데..."
3. Assistant: "궁금하신 점이 있으신가요? 무엇이든 물어보세요!..."

## 🔍 API 직접 테스트

### cURL 테스트

**1. 블로그 댓글 수집**
```bash
curl -X POST http://localhost:3000/api/blog-reviews/crawl-from-url \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_ADMIN_TOKEN" \
  -d '{
    "url": "https://blog.naver.com/aromapulse/223921529276"
  }'
```

**2. 블로그 게시물 목록 조회**
```bash
curl -X GET http://localhost:3000/api/blog-reviews/posts \
  -H "Authorization: Bearer YOUR_ADMIN_TOKEN"
```

**3. 특정 게시물 댓글 조회**
```bash
curl -X GET http://localhost:3000/api/blog-reviews/posts/223921529276/comments \
  -H "Authorization: Bearer YOUR_ADMIN_TOKEN"
```

## 🎉 테스트 완료 체크리스트

- [ ] 관리자 로그인 성공
- [ ] 블로그 관리 탭 표시 확인
- [ ] 블로그 URL 입력 및 댓글 수집 성공
- [ ] 수집 통계 알림 확인 (총 5개 댓글, 3개 구매 의도, 3개 챗봇 세션)
- [ ] 등록된 게시물 목록 표시 확인
- [ ] 게시물 통계 정보 표시 (댓글 수, B2C/B2B, 챗봇 세션)
- [ ] "게시물 보기" 버튼 동작 확인
- [ ] "댓글 보기" 버튼 동작 확인
- [ ] 탭 카운터 업데이트 확인
- [ ] 다른 탭과의 전환 동작 확인

---

**테스트 날짜**: 2025-11-14  
**테스트 버전**: v1.5.0  
**테스터**: _______  
**결과**: ✅ 성공 / ❌ 실패 / ⏳ 보류
