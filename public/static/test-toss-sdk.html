<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í† ìŠ¤í˜ì´ë¨¼ì¸  SDK í…ŒìŠ¤íŠ¸</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œ ìœ„ì ¯ SDK v2 -->
    <script src="https://js.tosspayments.com/v2/payment-widget"></script>
</head>
<body class="bg-gray-50 p-8">
    <div class="max-w-2xl mx-auto">
        <h1 class="text-3xl font-bold mb-6">í† ìŠ¤í˜ì´ë¨¼ì¸  SDK ë¡œë”© í…ŒìŠ¤íŠ¸</h1>
        
        <div class="bg-white p-6 rounded-lg shadow-md">
            <h2 class="text-xl font-bold mb-4">SDK ë¡œë”© ìƒíƒœ</h2>
            <div id="sdk-status" class="space-y-2"></div>
        </div>

        <div class="bg-white p-6 rounded-lg shadow-md mt-6">
            <h2 class="text-xl font-bold mb-4">ê²°ì œ ìœ„ì ¯ ì´ˆê¸°í™” í…ŒìŠ¤íŠ¸</h2>
            <button onclick="testPaymentWidget()" class="bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700 mb-4">
                ê²°ì œ ìœ„ì ¯ ì´ˆê¸°í™” í…ŒìŠ¤íŠ¸
            </button>
            <div id="test-result" class="mt-4"></div>
            <div id="payment-widget-container" class="mt-6"></div>
        </div>

        <div class="bg-yellow-50 border border-yellow-200 p-4 rounded-lg mt-6">
            <h3 class="font-bold mb-2">ğŸ“‹ í…ŒìŠ¤íŠ¸ ì •ë³´</h3>
            <pre id="test-info" class="text-sm bg-white p-3 rounded overflow-auto"></pre>
        </div>
    </div>

    <script>
        const TOSS_CLIENT_KEY = 'test_ck_eqRGgYO1r56JgBPB9nnW8QnN2Eya';
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ SDK ìƒíƒœ í™•ì¸
        window.addEventListener('load', function() {
            const statusDiv = document.getElementById('sdk-status');
            const testInfo = document.getElementById('test-info');
            
            let info = {
                sdkLoaded: typeof loadPaymentWidget !== 'undefined',
                sdkType: typeof loadPaymentWidget,
                windowKeys: Object.keys(window).filter(k => k.toLowerCase().includes('toss') || k.toLowerCase().includes('payment')),
                clientKey: TOSS_CLIENT_KEY
            };
            
            testInfo.textContent = JSON.stringify(info, null, 2);
            
            if (typeof loadPaymentWidget !== 'undefined') {
                statusDiv.innerHTML = `
                    <div class="bg-green-50 border border-green-200 p-4 rounded-lg">
                        <p class="text-green-800 font-bold">âœ… SDK ë¡œë“œ ì„±ê³µ!</p>
                        <p class="text-sm text-green-600 mt-2">loadPaymentWidget í•¨ìˆ˜ê°€ ì •ìƒì ìœ¼ë¡œ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.</p>
                    </div>
                `;
            } else {
                statusDiv.innerHTML = `
                    <div class="bg-red-50 border border-red-200 p-4 rounded-lg">
                        <p class="text-red-800 font-bold">âŒ SDK ë¡œë“œ ì‹¤íŒ¨</p>
                        <p class="text-sm text-red-600 mt-2">loadPaymentWidget í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
                        <p class="text-sm text-red-600 mt-2">F12 ì½˜ì†”ì—ì„œ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ë¥¼ í™•ì¸í•˜ì„¸ìš”.</p>
                    </div>
                `;
            }
        });

        // ê²°ì œ ìœ„ì ¯ ì´ˆê¸°í™” í…ŒìŠ¤íŠ¸
        async function testPaymentWidget() {
            const resultDiv = document.getElementById('test-result');
            const container = document.getElementById('payment-widget-container');
            
            try {
                resultDiv.innerHTML = '<p class="text-blue-600">ì´ˆê¸°í™” ì¤‘...</p>';
                
                if (typeof loadPaymentWidget === 'undefined') {
                    throw new Error('SDKê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤');
                }
                
                const customerKey = `TEST_CUSTOMER_${Date.now()}`;
                const amount = 38000;
                
                console.log('ê²°ì œ ìœ„ì ¯ ì´ˆê¸°í™” ì‹œë„:', {
                    clientKey: TOSS_CLIENT_KEY,
                    customerKey: customerKey,
                    amount: amount
                });
                
                // ê²°ì œìœ„ì ¯ ì´ˆê¸°í™”
                const paymentWidget = await loadPaymentWidget(TOSS_CLIENT_KEY, customerKey);
                
                console.log('ê²°ì œ ìœ„ì ¯ ê°ì²´ ìƒì„± ì„±ê³µ:', paymentWidget);
                
                // ê²°ì œ UI ë Œë”ë§
                await paymentWidget.renderPaymentMethods({
                    selector: '#payment-widget-container',
                    variantKey: 'DEFAULT'
                }, {
                    value: amount,
                    currency: 'KRW',
                    region: 'KR'
                });
                
                console.log('ê²°ì œ ìˆ˜ë‹¨ UI ë Œë”ë§ ì„±ê³µ');
                
                resultDiv.innerHTML = `
                    <div class="bg-green-50 border border-green-200 p-4 rounded-lg">
                        <p class="text-green-800 font-bold">âœ… ê²°ì œ ìœ„ì ¯ ì´ˆê¸°í™” ì„±ê³µ!</p>
                        <p class="text-sm text-green-600 mt-2">ì•„ë˜ì— ê²°ì œ ìˆ˜ë‹¨ ì„ íƒ UIê°€ í‘œì‹œë©ë‹ˆë‹¤.</p>
                    </div>
                `;
                
            } catch (error) {
                console.error('ê²°ì œ ìœ„ì ¯ ì´ˆê¸°í™” ì˜¤ë¥˜:', error);
                resultDiv.innerHTML = `
                    <div class="bg-red-50 border border-red-200 p-4 rounded-lg">
                        <p class="text-red-800 font-bold">âŒ ê²°ì œ ìœ„ì ¯ ì´ˆê¸°í™” ì‹¤íŒ¨</p>
                        <p class="text-sm text-red-600 mt-2">ì˜¤ë¥˜: ${error.message}</p>
                        <p class="text-sm text-red-600 mt-2">F12 ì½˜ì†”ì—ì„œ ìƒì„¸ ì˜¤ë¥˜ë¥¼ í™•ì¸í•˜ì„¸ìš”.</p>
                    </div>
                `;
            }
        }
    </script>
</body>
</html>
